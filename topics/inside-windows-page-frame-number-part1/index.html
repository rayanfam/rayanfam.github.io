<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Inside Windows Page Frame Number (PFN) - Part 1" /><meta name="author" content="Sina Karvandi" /><meta property="og:locale" content="en" /><meta name="description" content="We write about Windows Internals, Hypervisors, Linux, and Networks." /><meta property="og:description" content="We write about Windows Internals, Hypervisors, Linux, and Networks." /><link rel="canonical" href="https://rayanfam.com/topics/inside-windows-page-frame-number-part1/" /><meta property="og:url" content="https://rayanfam.com/topics/inside-windows-page-frame-number-part1/" /><meta property="og:site_name" content="Rayanfam Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-07-19T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Inside Windows Page Frame Number (PFN) - Part 1" /><meta name="twitter:site" content="@Intel80x86" /><meta name="twitter:creator" content="@Sina Karvandi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sina Karvandi"},"dateModified":"2024-07-13T12:45:21+00:00","datePublished":"2018-07-19T00:00:00+00:00","description":"We write about Windows Internals, Hypervisors, Linux, and Networks.","headline":"Inside Windows Page Frame Number (PFN) - Part 1","mainEntityOfPage":{"@type":"WebPage","@id":"https://rayanfam.com/topics/inside-windows-page-frame-number-part1/"},"url":"https://rayanfam.com/topics/inside-windows-page-frame-number-part1/"}</script><title>Inside Windows Page Frame Number (PFN) - Part 1 | Rayanfam Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rayanfam Blog"><meta name="application-name" content="Rayanfam Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rayanfam Blog</a></div><div class="site-subtitle font-italic">An aggressive out-of-order, superscalar blog...</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tutorials/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>TUTORIALS</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>TOOLS & SCRIPTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/rayanfam" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Intel80x86" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sina','rayanfam.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Inside Windows Page Frame Number (PFN) - Part 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Inside Windows Page Frame Number (PFN) - Part 1</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Intel80x86">Sina Karvandi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1531958400" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2018-07-19 </em> </span> <span> Updated <em class="timeago" data-ts="1720874721" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-07-13 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1696 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="../../assets/images/pfn-1-cover.png" alt="" data-proofer-ignore></p><h2 id="introduction-page-frame-number"><span class="mr-2">Introduction (Page Frame Number)</span><a href="#introduction-page-frame-number" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Windows and almost all the OSs use Page Frame Number Database in order to have a track of virtually allocated pages to know which page must be freed or evicted or if a page needs to be cached and etc.</p><p>All of these kinds of stuff manages through a list, called Page Frame Number (PFN). A long list of explanation about the states of every physically and virtually allocated pages and its corresponding attributes.</p><p>In the rest of this post, I’ll explain about Windows implementation of Page Frame Number with lots of practical examples, the following part describes basic concepts implementations, you should also read the next part in order to see how can you use or change these attributes.</p><p>If you’re familiar with non-PAE mode and PAE mode systems then I should note that in a non-PAE mode every PFN structure takes 24 bytes while in a PAE mode system this size increases to 28 so if your pages are 4096 bytes then allocates about 24 bytes more to keep tracks of every page.</p><p>As you can see <a href="https://social.technet.microsoft.com/wiki/contents/articles/15259.page-frame-number-pfn-database.aspx">here</a>:</p><blockquote><p>In non-PAE mode 24 bytes in the PFN database represents each 4 KB page of physical memory – this is a ratio of 170:1. In PAE mode 28 bytes represents each 4 KB page of physical memory – this is a ratio of 146:1. This means that roughly 6 MB or 7 MB is needed in the PFN database to describe each 1 GB of physical memory. This might not sound like much, but if you have a 32-bit system with 16 GB of physical memory, then it requires about 112 MB of the 2 GB of kernel virtual address space just to address the RAM. This is another reason why systems with 16 GB of physical memory or more will not allow the 3GB mode (also known as IncreaseUserVA) which increases the user virtual address space to 3 GB and decreases the kernel virtual address space to 1 GB on 32-bit systems.</p></blockquote><p>One of the benefits of having extended pages (e.g 2MB for every page) is that it needs lower amounts of MMPFN.</p><p>Before start getting deep into the PFN, please remember the term “Page” is mostly used in the operating system level concepts whereas “Frame” is used in CPU Level concepts, therefore “Page” means virtual page and “Page Frame” means physical page.</p><h2 id="pfn-lists"><span class="mr-2">PFN Lists</span><a href="#pfn-lists" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The Page Frame Number consists of lists that describe the state of some pages, there are <strong>Active Lists</strong> which shows an active page (e.g in working sets or etc), <strong>Standby List</strong> which means a list that previously backed in the disk and the page itself can be emptied and reused without incurring a disk IO, <strong>Modified List</strong> which shows that the page is previously modified and somehow must be written to the disk, <strong>Freed List,</strong> as the name describes, it shows a page that is no longer needed to be maintained and can be freed and finally <strong>Zero List</strong> that describes a page that is free and has all zeroes (0) in it.</p><p>A great picture derived from <a href="https://flylib.com/books/en/4.491.1.69/1/">here</a> which shows how the PFN database lists are related to each other :</p><p><img data-src="../../assets/images/pfn-structure.gif" alt="PFN" data-proofer-ignore></p><p>These lists are used to manage memory in “page faults” state in the way that everytime a “page fault” occurs, Windows tries to find an available page form, <strong>Zero List</strong>, if the list is empty then it gets one from <strong>Freed List</strong> and zeroes the page and use it, on the other hand, if the <strong>Freed List</strong> is also empty then it goes to the <strong>Standby List</strong> and zeroes that page.</p><h2 id="the-zero-page-thread"><span class="mr-2">The Zero Page Thread</span><a href="#the-zero-page-thread" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>In Windows, there is a thread with the priority of 0 which is responsible for zeroing memory when system is idle and is the only thread in the entire system that runs at priority 0. (which is the lowest available priority because the user threads are at least 1). This thread clears the <strong>Freed List</strong> whenever is possible. Also, there is a function in Windows called <strong>RtlSecureZeroMemory()</strong> which frees a location securely but in the kernel perspective <strong>nt!KeZeroPages</strong> is responsible for freeing the pages.</p><p>The following picture shows the behavior of zero-thread:</p><p><img data-src="../../assets/images/zero-thread.png" alt="Zero-thread" data-proofer-ignore></p><p>Let’s find the Zero Thread!</p><p>We know that it comes from system process, its priority is 0, this should be enough and nothing more is needed. First try to find <strong>System</strong>’s nt!_eprocess:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">!</span><span class="n">process</span> <span class="mi">0</span> <span class="n">System</span>
</pre></table></code></div></div><p>Now we can see the <strong>System</strong>’s threads, the details of our target thread (zero-thread) are:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>        <span class="n">THREAD</span> <span class="n">ffffd4056ed00040</span>  <span class="n">Cid</span> <span class="mo">0004</span><span class="p">.</span><span class="mo">0040</span>  <span class="n">Teb</span><span class="o">:</span> <span class="mo">0000000000000000</span> <span class="n">Win32Thread</span><span class="o">:</span> <span class="mo">0000000000000000</span> <span class="n">WAIT</span><span class="o">:</span> <span class="p">(</span><span class="n">WrFreePage</span><span class="p">)</span> <span class="n">KernelMode</span> <span class="n">Non</span><span class="o">-</span><span class="n">Alertable</span>
            <span class="n">fffff8034637f148</span>  <span class="n">NotificationEvent</span>
            <span class="n">fffff80346380480</span>  <span class="n">NotificationEvent</span>
        <span class="n">Not</span> <span class="n">impersonating</span>
        <span class="n">DeviceMap</span>                 <span class="n">ffff99832ae1b010</span>
        <span class="n">Owning</span> <span class="n">Process</span>            <span class="n">ffffd4056ec56040</span>       <span class="n">Image</span><span class="o">:</span>         <span class="n">System</span>
        <span class="n">Attached</span> <span class="n">Process</span>          <span class="n">N</span><span class="o">/</span><span class="n">A</span>            <span class="n">Image</span><span class="o">:</span>         <span class="n">N</span><span class="o">/</span><span class="n">A</span>
        <span class="n">Wait</span> <span class="n">Start</span> <span class="n">TickCount</span>      <span class="mi">4910</span>           <span class="n">Ticks</span><span class="o">:</span> <span class="mi">4</span> <span class="p">(</span><span class="mi">0</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">.</span><span class="mo">062</span><span class="p">)</span>
        <span class="n">Context</span> <span class="n">Switch</span> <span class="n">Count</span>      <span class="mi">21023</span>          <span class="n">IdealProcessor</span><span class="o">:</span> <span class="mi">3</span>             
        <span class="n">UserTime</span>                  <span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="p">.</span><span class="mo">000</span>
        <span class="n">KernelTime</span>                <span class="mo">00</span><span class="o">:</span><span class="mo">00</span><span class="o">:</span><span class="mo">01</span><span class="p">.</span><span class="mi">109</span>
        <span class="n">Win32</span> <span class="n">Start</span> <span class="n">Address</span> <span class="n">nt</span><span class="o">!</span><span class="n">MiZeroPageThread</span> <span class="p">(</span><span class="mh">0xfffff80346144ed0</span><span class="p">)</span>
        <span class="n">Stack</span> <span class="n">Init</span> <span class="n">ffffe700b7c14c90</span> <span class="n">Current</span> <span class="n">ffffe700b7c14570</span>
        <span class="n">Base</span> <span class="n">ffffe700b7c15000</span> <span class="n">Limit</span> <span class="n">ffffe700b7c0f000</span> <span class="n">Call</span> <span class="mo">0000000000000000</span>
        <span class="n">Priority</span> <span class="mi">0</span> <span class="n">BasePriority</span> <span class="mi">0</span> <span class="n">PriorityDecrement</span> <span class="mi">0</span> <span class="n">IoPriority</span> <span class="mi">2</span> <span class="n">PagePriority</span> <span class="mi">5</span>
        <span class="n">Child</span><span class="o">-</span><span class="n">SP</span>          <span class="n">RetAddr</span>           <span class="n">Call</span> <span class="n">Site</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c145b0</span> <span class="n">fffff803</span><span class="err">`</span><span class="mi">46016</span><span class="n">f8a</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiSwapContext</span><span class="o">+</span><span class="mh">0x76</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c146f0</span> <span class="n">fffff803</span><span class="err">`</span><span class="mi">46016951</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiSwapThread</span><span class="o">+</span><span class="mh">0x16a</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c147a0</span> <span class="n">fffff803</span><span class="err">`</span><span class="mi">46014</span><span class="n">ba7</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiCommitThreadWait</span><span class="o">+</span><span class="mh">0x101</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c14840</span> <span class="n">fffff803</span><span class="err">`</span><span class="mi">461450</span><span class="n">b7</span> <span class="n">nt</span><span class="o">!</span><span class="n">KeWaitForMultipleObjects</span><span class="o">+</span><span class="mh">0x217</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c14920</span> <span class="n">fffff803</span><span class="err">`</span><span class="mi">460</span><span class="n">bba37</span> <span class="n">nt</span><span class="o">!</span><span class="n">MiZeroPageThread</span><span class="o">+</span><span class="mh">0x1e7</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c14c10</span> <span class="n">fffff803</span><span class="err">`</span><span class="mi">46173456</span> <span class="n">nt</span><span class="o">!</span><span class="n">PspSystemThreadStartup</span><span class="o">+</span><span class="mh">0x47</span>
        <span class="n">ffffe700</span><span class="err">`</span><span class="n">b7c14c60</span> <span class="mo">00000000</span><span class="err">`</span><span class="mo">00000000</span> <span class="n">nt</span><span class="o">!</span><span class="n">KiStartSystemThread</span><span class="o">+</span><span class="mh">0x16</span>
</pre></table></code></div></div><p>As you can see, its start address is at <strong>nt!MiZeroPageThread</strong> and its priority-level is 0 and if we see the call-stack then we can see nt!MiZeroPageThread was called previously.</p><p>For more information please visit <a href="https://randomascii.wordpress.com/2014/12/10/hidden-costs-of-memory-allocation/"><strong>Hidden Costs of Memory Allocation</strong></a>.</p><h2 id="nt_mmpfn"><span class="mr-2">nt!_MMPFN</span><a href="#nt_mmpfn" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The Windows structure for PFN is nt!_MMPFN which you can see below :</p><p><img data-src="../../assets/images/mmpfn.png" alt="MMPFN" data-proofer-ignore></p><p>As you see, _MMPFN takes 28 bytes.</p><p>PFN records are stored in the memory based on their physical address order which means you can always calculate the physical address with the help of PFN.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">Physical</span> <span class="n">Address</span> <span class="o">=</span> <span class="n">PFN</span> <span class="o">*</span> <span class="n">page</span> <span class="n">size</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">g</span> <span class="mi">4096</span> <span class="n">Byte</span><span class="p">)</span> <span class="o">+</span> <span class="n">offset</span>
</pre></table></code></div></div><p>The address of the PFN database is located at <strong>nt!MmPfnDatabase</strong>, you can use the following example to get your PFN database address in Windbg.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="mi">2</span><span class="o">:</span> <span class="n">kd</span><span class="o">&gt;</span> <span class="n">x</span> <span class="n">nt</span><span class="o">!</span><span class="n">MmPfnDatabase</span>
<span class="n">fffff800</span><span class="err">`</span><span class="n">a2a76048</span> <span class="n">nt</span><span class="o">!</span><span class="n">MmPfnDatabase</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">no</span> <span class="n">type</span> <span class="n">information</span><span class="o">&gt;</span>
</pre></table></code></div></div><h2 id="memusage"><span class="mr-2">!memusage</span><a href="#memusage" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Another very useful command in windbg is !memusage, this command gives almost everything about PFN and pages in your memory layout and its corresponding details (e.g files, fonts, system drivers, DLL modules, executable files including their names and their paging bits modifications).</p><p>A brief sample of this command is shown below :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
</pre><td class="rouge-code"><pre><span class="mi">2</span><span class="o">:</span> <span class="n">kd</span><span class="o">&gt;</span> <span class="o">!</span><span class="n">memusage</span>
 <span class="n">loading</span> <span class="n">PFN</span> <span class="n">database</span>
<span class="n">loading</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="n">Compiling</span> <span class="n">memory</span> <span class="n">usage</span> <span class="n">data</span> <span class="p">(</span><span class="mi">99</span><span class="o">%</span> <span class="n">Complete</span><span class="p">).</span>
             <span class="n">Zeroed</span><span class="o">:</span>     <span class="mi">9841</span> <span class="p">(</span>   <span class="mi">39364</span> <span class="n">kb</span><span class="p">)</span>
               <span class="n">Free</span><span class="o">:</span>   <span class="mi">113298</span> <span class="p">(</span>  <span class="mi">453192</span> <span class="n">kb</span><span class="p">)</span>
            <span class="n">Standby</span><span class="o">:</span>   <span class="mi">105520</span> <span class="p">(</span>  <span class="mi">422080</span> <span class="n">kb</span><span class="p">)</span>
           <span class="n">Modified</span><span class="o">:</span>     <span class="mi">7923</span> <span class="p">(</span>   <span class="mi">31692</span> <span class="n">kb</span><span class="p">)</span>
    <span class="n">ModifiedNoWrite</span><span class="o">:</span>        <span class="mi">0</span> <span class="p">(</span>       <span class="mi">0</span> <span class="n">kb</span><span class="p">)</span>
       <span class="n">Active</span><span class="o">/</span><span class="n">Valid</span><span class="o">:</span>   <span class="mi">286963</span> <span class="p">(</span> <span class="mi">1147852</span> <span class="n">kb</span><span class="p">)</span>
         <span class="n">Transition</span><span class="o">:</span>       <span class="mi">45</span> <span class="p">(</span>     <span class="mi">180</span> <span class="n">kb</span><span class="p">)</span>
          <span class="n">SLIST</span><span class="o">/</span><span class="n">Bad</span><span class="o">:</span>      <span class="mi">567</span> <span class="p">(</span>    <span class="mi">2268</span> <span class="n">kb</span><span class="p">)</span>
            <span class="n">Unknown</span><span class="o">:</span>        <span class="mi">0</span> <span class="p">(</span>       <span class="mi">0</span> <span class="n">kb</span><span class="p">)</span>
              <span class="n">TOTAL</span><span class="o">:</span>   <span class="mi">524157</span> <span class="p">(</span> <span class="mi">2096628</span> <span class="n">kb</span><span class="p">)</span>

<span class="n">Dangling</span> <span class="n">Yes</span> <span class="n">Commit</span><span class="o">:</span>      <span class="mi">140</span> <span class="p">(</span>     <span class="mi">560</span> <span class="n">kb</span><span class="p">)</span>
 <span class="n">Dangling</span> <span class="n">No</span> <span class="n">Commit</span><span class="o">:</span>    <span class="mi">37589</span> <span class="p">(</span>  <span class="mi">150356</span> <span class="n">kb</span><span class="p">)</span>
  <span class="n">Building</span> <span class="n">kernel</span> <span class="n">map</span>
  <span class="n">Finished</span> <span class="n">building</span> <span class="n">kernel</span> <span class="n">map</span>

 <span class="p">(</span><span class="n">Master1</span> <span class="mi">0</span> <span class="k">for</span> <span class="mi">80</span><span class="p">)</span>

 <span class="p">(</span><span class="n">Master1</span> <span class="mi">0</span> <span class="k">for</span> <span class="mi">580</span><span class="p">)</span>

 <span class="p">(</span><span class="n">Master1</span> <span class="mi">0</span> <span class="k">for</span> <span class="mi">800</span><span class="p">)</span>

 <span class="p">(</span><span class="n">Master1</span> <span class="mi">0</span> <span class="k">for</span> <span class="mi">980</span><span class="p">)</span>
<span class="n">Scanning</span> <span class="n">PFN</span> <span class="n">database</span> <span class="o">-</span> <span class="p">(</span><span class="mi">97</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span> 
 <span class="p">(</span><span class="n">Master1</span> <span class="mi">0</span> <span class="k">for</span> <span class="mi">7</span><span class="n">d100</span><span class="p">)</span>
<span class="n">Scanning</span> <span class="n">PFN</span> <span class="n">database</span> <span class="o">-</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span> 

  <span class="n">Usage</span> <span class="n">Summary</span> <span class="p">(</span><span class="n">in</span> <span class="n">Kb</span><span class="p">)</span><span class="o">:</span>
<span class="n">Control</span>       <span class="n">Valid</span> <span class="n">Standby</span> <span class="n">Dirty</span> <span class="n">Shared</span> <span class="n">Locked</span> <span class="n">PageTables</span>  <span class="n">name</span>
<span class="n">ffffffffd</span> <span class="mi">11288</span>      <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span> <span class="mi">11288</span>     <span class="mi">0</span>    <span class="n">AWE</span>
<span class="n">ffffd4056ec4c460</span>     <span class="mi">0</span>    <span class="mi">112</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">LeelUIsl</span><span class="p">.</span><span class="n">ttf</span> <span class="p">)</span>
<span class="n">ffffd4056ec4c8f0</span>     <span class="mi">0</span>    <span class="mi">160</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">malgun</span><span class="p">.</span><span class="n">ttf</span> <span class="p">)</span>
<span class="n">ffffd4056ec4d6b0</span>     <span class="mi">0</span>    <span class="mi">108</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">framd</span><span class="p">.</span><span class="n">ttf</span> <span class="p">)</span>

<span class="p">.....</span>

<span class="n">ffffd4057034ecd0</span>   <span class="mi">328</span>    <span class="mi">148</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">usbport</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>
<span class="n">ffffd4057034f0e0</span>    <span class="mi">48</span>     <span class="mi">28</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">mouclass</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>
<span class="n">ffffd4057034f7d0</span>    <span class="mi">32</span>     <span class="mi">28</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">serenum</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>
<span class="n">ffffd405703521a0</span>     <span class="mi">0</span>     <span class="mi">20</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>  <span class="n">mapped_file</span><span class="p">(</span> <span class="n">swenum</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>

<span class="p">.....</span>

<span class="o">--------</span> <span class="mi">0</span>     <span class="mi">20</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">0</span>  <span class="n">session</span> <span class="mi">0</span> <span class="mi">0</span>
<span class="o">--------</span> <span class="mi">4</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">0</span>  <span class="n">session</span> <span class="mi">0</span> <span class="n">ffffe700b8b45000</span>
<span class="o">--------</span> <span class="mi">4</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">0</span>  <span class="n">session</span> <span class="mi">1</span> <span class="n">ffffe700b8ead000</span>
<span class="o">--------</span> <span class="mi">32520</span>      <span class="mi">0</span>    <span class="mi">84</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">1324</span>  <span class="n">process</span> <span class="p">(</span> <span class="n">System</span> <span class="p">)</span> <span class="n">ffffd4056ec56040</span>
<span class="o">--------</span> <span class="mi">2676</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">304</span>  <span class="n">process</span> <span class="p">(</span> <span class="n">msdtc</span><span class="p">.</span><span class="n">exe</span> <span class="p">)</span> <span class="n">ffffd405717567c0</span>
<span class="o">--------</span> <span class="mi">4444</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">368</span>  <span class="n">process</span> <span class="p">(</span> <span class="n">WmiPrvSE</span><span class="p">.</span><span class="n">exe</span> <span class="p">)</span> <span class="n">ffffd405718057c0</span>
<span class="o">--------</span> <span class="mi">37756</span>      <span class="mi">0</span>    <span class="mi">60</span> <span class="o">-----</span> <span class="o">-----</span> <span class="mi">1028</span>  <span class="n">process</span> <span class="p">(</span> <span class="n">SearchUI</span><span class="p">.</span><span class="n">exe</span> <span class="p">)</span> <span class="n">ffffd405718e87c0</span>

<span class="p">.....</span>

<span class="o">--------</span> <span class="mi">8</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="mi">0</span> <span class="o">-----</span> <span class="n">driver</span> <span class="p">(</span> <span class="n">condrv</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>
<span class="o">--------</span> <span class="mi">8</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="mi">0</span> <span class="o">-----</span> <span class="n">driver</span> <span class="p">(</span> <span class="n">WdNisDrv</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>
<span class="o">--------</span> <span class="mi">52</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="mi">0</span> <span class="o">-----</span> <span class="n">driver</span> <span class="p">(</span> <span class="n">peauth</span><span class="p">.</span><span class="n">sys</span> <span class="p">)</span>
<span class="o">--------</span> <span class="mi">24744</span>      <span class="mi">0</span>     <span class="mi">0</span> <span class="o">-----</span> <span class="mi">0</span> <span class="o">-----</span> <span class="p">(</span> <span class="n">PFN</span> <span class="n">Database</span> <span class="p">)</span>
<span class="n">Summary</span>   <span class="mi">1147852</span>  <span class="mi">422260</span> <span class="mi">31692</span> <span class="mi">129996</span> <span class="mi">204428</span> <span class="mi">25156</span>  <span class="n">Total</span>

<span class="p">.....</span>

    <span class="n">b45b</span>    <span class="mi">64</span>      <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">60</span>     <span class="mi">0</span>     <span class="mi">0</span>   <span class="n">Page</span> <span class="n">File</span> <span class="n">Section</span>
    <span class="n">b56b</span>     <span class="mi">4</span>      <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">0</span>     <span class="mi">0</span>   <span class="n">Page</span> <span class="n">File</span> <span class="n">Section</span>
    <span class="n">b7ec</span>    <span class="mi">84</span>      <span class="mi">0</span>     <span class="mi">0</span>    <span class="mi">64</span>     <span class="mi">0</span>     <span class="mi">0</span>   <span class="n">Page</span> <span class="n">File</span> <span class="n">Section</span>
    <span class="n">b905</span>    <span class="mi">12</span>      <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>   <span class="n">Page</span> <span class="n">File</span> <span class="n">Section</span>
    <span class="n">bf5c</span>     <span class="mi">4</span>      <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>     <span class="mi">0</span>   <span class="n">Page</span> <span class="n">File</span> <span class="n">Section</span>
	
<span class="p">.....</span>
</pre></table></code></div></div><p>Note that !memusage takes a long time to finish its probes.</p><p>What if you want to know more about these pages? The Windbg help document mentioned :</p><blockquote><h2 id="remarks"><span class="mr-2">Remarks</span><a href="#remarks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>You can use the <strong>!vm</strong> extension command to analyze virtual memory use. This extension is typically more useful than <strong>!memusage</strong>. For more information about memory management, see <em>Microsoft Windows Internals</em>, by Mark Russinovich and David Solomon. (This book may not be available in some languages and countries.)</p><p>The <strong>!pfn</strong> extension command can be used to display a particular page frame entry in the PFN database.</p></blockquote><p>Now we want survey among these command in a more detailed perspective.</p><p>That’s enough for now… I try to make another part that describes the PFN more practically, so make sure to check the blog more frequently.</p><p>The second part is also published at <a href="https://rayanfam.com/topics/inside-windows-page-frame-number-pfn-part2/">Inside Windows Page Frame Number (PFN) – Part 2</a>.</p><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>[Getting Physical: Extreme abuse of Intel-based Paging Systems - Part 2 - Windows] (<a href="https://www.coresecurity.com/blog/getting-physical-extreme-abuse-of-intel-based-paging-systems-part-2-windows">https://www.coresecurity.com/blog/getting-physical-extreme-abuse-of-intel-based-paging-systems-part-2-windows</a>)<li>[Page Frame Number (PFN) database] <a href="https://social.technet.microsoft.com/wiki/contents/articles/15259.page-frame-number-pfn-database.aspx">(https://social.technet.microsoft.com/wiki/contents/articles/15259.page-frame-number-pfn-database.aspx)</a><li>[Exploring Windows virtual memory management] (<a href="https://www.triplefault.io/2017/08/exploring-windows-virtual-memory.html">https://www.triplefault.io/2017/08/exploring-windows-virtual-memory.html</a>)<li>[Page Frame Number Database] (<a href="https://flylib.com/books/en/4.491.1.69/1/">https://flylib.com/books/en/4.491.1.69/1/</a>)<li>[PDC10: Mysteries of Windows Memory Management Revealed: Part Two] (<a href="https://blogs.msdn.microsoft.com/tims/2010/10/29/pdc10-mysteries-of-windows-memory-management-revealed-part-two/">https://blogs.msdn.microsoft.com/tims/2010/10/29/pdc10-mysteries-of-windows-memory-management-revealed-part-two/</a>)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/debugging/'>debugging</a>, <a href='/categories/kernel-mode/'>kernel-mode</a>, <a href='/categories/windows/'>windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/freed-list/" class="post-tag no-text-decoration" >freed-list</a> <a href="/tags/mizeropagethread/" class="post-tag no-text-decoration" >mizeropagethread</a> <a href="/tags/mmpfndatabase/" class="post-tag no-text-decoration" >mmpfndatabase</a> <a href="/tags/page-frame-number/" class="post-tag no-text-decoration" >page-frame-number</a> <a href="/tags/page-management-in-windows/" class="post-tag no-text-decoration" >page-management-in-windows</a> <a href="/tags/pfn/" class="post-tag no-text-decoration" >pfn</a> <a href="/tags/pfn-database/" class="post-tag no-text-decoration" >pfn-database</a> <a href="/tags/pfn-in-windows/" class="post-tag no-text-decoration" >pfn-in-windows</a> <a href="/tags/pfn-list-corrupt/" class="post-tag no-text-decoration" >pfn_list_corrupt</a> <a href="/tags/standby-list/" class="post-tag no-text-decoration" >standby-list</a> <a href="/tags/windows-mmpfn-structure/" class="post-tag no-text-decoration" >windows-mmpfn-structure</a> <a href="/tags/windows-paging/" class="post-tag no-text-decoration" >windows-paging</a> <a href="/tags/zero-thread/" class="post-tag no-text-decoration" >zero-thread</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Inside Windows Page Frame Number (PFN) - Part 1 - Rayanfam Blog&amp;url=https://rayanfam.com/topics/inside-windows-page-frame-number-part1/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Inside Windows Page Frame Number (PFN) - Part 1 - Rayanfam Blog&amp;u=https://rayanfam.com/topics/inside-windows-page-frame-number-part1/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://rayanfam.com/topics/inside-windows-page-frame-number-part1/&amp;text=Inside Windows Page Frame Number (PFN) - Part 1 - Rayanfam Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/topics/hypervisor-from-scratch-part-1/">Hypervisor From Scratch - Part 1: Basic Concepts & Configure Testing Environment</a><li><a href="/topics/hypervisor-from-scratch-part-2/">Hypervisor From Scratch – Part 2: Entering VMX Operation</a><li><a href="/topics/hypervisor-from-scratch-part-5/">Hypervisor From Scratch – Part 5: Setting up VMCS & Running Guest Code</a><li><a href="/topics/hypervisor-from-scratch-part-6/">Hypervisor From Scratch – Part 6: Virtualizing An Already Running System</a><li><a href="/topics/hypervisor-from-scratch-part-7/">Hypervisor From Scratch – Part 7: Using EPT & Page-Level Monitoring Features</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hypervisor/">hypervisor</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/cisco/">cisco</a> <a class="post-tag" href="/tags/invept/">invept</a> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/vmcs/">vmcs</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/cache/">cache</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/topics/inside-windows-page-frame-number-part2/"><div class="card-body"> <em class="timeago small" data-ts="1533600000" > 2018-08-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Inside Windows Page Frame Number (PFN) – Part 2</h3><div class="text-muted small"><p> Hey there, In the previous part, I’d explained about Page Frame Number and its importance in the OSs architecture. In this part, I’ll trace PFN more practically. I strongly recommend to read the...</p></div></div></a></div><div class="card"> <a href="/topics/finding-the-real-access-rights-needed-by-handles/"><div class="card-body"> <em class="timeago small" data-ts="1559779200" > 2019-06-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Why you should not always trust MSDN: Finding Real Access Rights Needed By Handles</h3><div class="text-muted small"><p> Introduction Hi guys, The title of this topic is somehow weird, if you think everything in MSDN is 100% match with what Microsoft implemented in Windows (like what I used to think), you’re defi...</p></div></div></a></div><div class="card"> <a href="/topics/fooling-windows-about-cpu/"><div class="card-body"> <em class="timeago small" data-ts="1506816000" > 2017-10-01 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Fooling Windows about its internal CPU</h3><div class="text-muted small"><p> In this post, I’m gonna show you how you can fool windows about its internal structure and sometimes give it wrong information about its internal capabilities or internal information which can br...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/topics/captive-portal-detection-sample/" class="btn btn-outline-primary" prompt="Older"><p>Captive portal detection with a working sample in all major OSs!</p></a> <a href="/topics/cisco-switch-sec-cheatsheet/" class="btn btn-outline-primary" prompt="Newer"><p>Cisco switch security features cheatsheet</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://rayanfam.com/topics/inside-windows-page-frame-number-part1/'; this.page.identifier = '/topics/inside-windows-page-frame-number-part1/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://rayanfam.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/rayanfam">Rayanfam Blog</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hypervisor/">hypervisor</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/cisco/">cisco</a> <a class="post-tag" href="/tags/invept/">invept</a> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/vmcs/">vmcs</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/cache/">cache</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-P6M1BDG57Z"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-P6M1BDG57Z'); }); </script>
