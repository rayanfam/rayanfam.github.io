<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Fooling Windows about its internal CPU" /><meta name="author" content="Sina Karvandi" /><meta property="og:locale" content="en" /><meta name="description" content="We write about Windows Internals, Hypervisors, Linux, and Networks." /><meta property="og:description" content="We write about Windows Internals, Hypervisors, Linux, and Networks." /><link rel="canonical" href="https://rayanfam.com/topics/fooling-windows-about-cpu/" /><meta property="og:url" content="https://rayanfam.com/topics/fooling-windows-about-cpu/" /><meta property="og:site_name" content="Rayanfam Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2017-10-01T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Fooling Windows about its internal CPU" /><meta name="twitter:site" content="@Intel80x86" /><meta name="twitter:creator" content="@Sina Karvandi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sina Karvandi"},"dateModified":"2024-07-13T12:45:21+00:00","datePublished":"2017-10-01T00:00:00+00:00","description":"We write about Windows Internals, Hypervisors, Linux, and Networks.","headline":"Fooling Windows about its internal CPU","mainEntityOfPage":{"@type":"WebPage","@id":"https://rayanfam.com/topics/fooling-windows-about-cpu/"},"url":"https://rayanfam.com/topics/fooling-windows-about-cpu/"}</script><title>Fooling Windows about its internal CPU | Rayanfam Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rayanfam Blog"><meta name="application-name" content="Rayanfam Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rayanfam Blog</a></div><div class="site-subtitle font-italic">An aggressive out-of-order, superscalar blog...</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tutorials/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>TUTORIALS</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>TOOLS & SCRIPTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/rayanfam" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Intel80x86" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sina','rayanfam.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Fooling Windows about its internal CPU</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Fooling Windows about its internal CPU</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Intel80x86">Sina Karvandi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1506816000" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2017-10-01 </em> </span> <span> Updated <em class="timeago" data-ts="1720874721" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-07-13 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2357 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="../../assets/images/kids-watching-laptop.jpg" alt="" data-proofer-ignore></p><p>In this post, I’m gonna show you how you can fool windows about its internal structure and sometimes give it wrong information about its internal capabilities or internal information which can bring you a lot of fun. (At least for me !)</p><p>But don’t do that it can hurt your system actually but this post is about how to change CPU Capacity measurement of Windows and see its result in user-mode programs.</p><p>There is a good article <a href="http://www.codemachine.com/article_kernelstruct.html">here</a> which gives you lots of information. I recommend seeing all its structures before start reading rest of this post.</p><p>Ok, As you know windows contains lots of structures which stores its internal information about the system which is running on and almost all of this information can be found by using NtQuerySystemInformation and you can see all about it on <a href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms724509(v=vs.85).aspx">MSDN</a> (In the future post I will give you more details about this function.)</p><p>I’m gonna use nt!_KPCR and Code Machine describes it well :</p><h4 id="nt_kpcr"><span class="mr-2">nt!_KPCR</span><a href="#nt_kpcr" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p><em>KPCR represents the Kernel Processor Control Region. The KPCR contains per-CPU information which is shared by the kernel and the HAL. There are as many KPCR in the system as there are CPUs.</em></p><p><em>The KPCR of the current CPU is always accessible at fs:[0] on the x86 systems and gs:[0] on x64 systems. Commonly used kernel functions like PsGetCurrentProcess() and KeGetCurrentThread() retrieve information from the KPCR using the FS/GS relative accesses.</em></p><p><em>The <strong>Prcb</strong> field contains an embedded KPRCB structure that represents the Kernel Processor Control Block.</em></p><p><em>The debugger’s “!pcr” command displays partial contents of the PCR.</em></p><p>You can see all Windbg gives to you from Windows symbols :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="n">lkd</span><span class="o">&gt;</span> <span class="n">dt</span> <span class="n">nt</span><span class="o">!</span><span class="n">_KPCR</span>
<span class="o">+</span><span class="mh">0x000</span> <span class="n">NtTib</span> <span class="o">:</span> <span class="n">_NT_TIB</span>
<span class="o">+</span><span class="mh">0x000</span> <span class="n">GdtBase</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KGDTENTRY64</span>
<span class="o">+</span><span class="mh">0x008</span> <span class="n">TssBase</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KTSS64</span>
<span class="o">+</span><span class="mh">0x010</span> <span class="n">UserRsp</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x018</span> <span class="n">Self</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KPCR</span>
<span class="o">+</span><span class="mh">0x020</span> <span class="n">CurrentPrcb</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KPRCB</span>
<span class="o">+</span><span class="mh">0x028</span> <span class="n">LockArray</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KSPIN_LOCK_QUEUE</span>
<span class="o">+</span><span class="mh">0x030</span> <span class="n">Used_Self</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x038</span> <span class="n">IdtBase</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KIDTENTRY64</span>
<span class="o">+</span><span class="mh">0x040</span> <span class="n">Unused</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x050</span> <span class="n">Irql</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x051</span> <span class="n">SecondLevelCacheAssociativity</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x052</span> <span class="n">ObsoleteNumber</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x053</span> <span class="n">Fill0</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x054</span> <span class="n">Unused0</span> <span class="o">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x060</span> <span class="n">MajorVersion</span> <span class="o">:</span> <span class="n">Uint2B</span>
<span class="o">+</span><span class="mh">0x062</span> <span class="n">MinorVersion</span> <span class="o">:</span> <span class="n">Uint2B</span>
<span class="o">+</span><span class="mh">0x064</span> <span class="n">StallScaleFactor</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x068</span> <span class="n">Unused1</span> <span class="o">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x080</span> <span class="n">KernelReserved</span> <span class="o">:</span> <span class="p">[</span><span class="mi">15</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0bc</span> <span class="n">SecondLevelCacheSize</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0c0</span> <span class="n">HalReserved</span> <span class="o">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x100</span> <span class="n">Unused2</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x108</span> <span class="n">KdVersionBlock</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x110</span> <span class="n">Unused3</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x118</span> <span class="n">PcrAlign1</span> <span class="o">:</span> <span class="p">[</span><span class="mi">24</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x180</span> <span class="n">Prcb</span> <span class="o">:</span> <span class="n">_KPRCB</span>
</pre></table></code></div></div><p>There are lots of great information about Idt , IRQL in the above structure so it must be an important one!</p><p>Look at the last one, which is Prcb!</p><p>Mark Russinovich in Windows Internals wrote “The PCR and PRCB contain information about the state of each processor in the system such as current IRQL, a pointer to the hardware Idt, the currently running thread, and the next thread selected to run. The kernel and the HAL use this information to perform architecture-specific and machine-specific actions.”.</p><p>So all we need is seeing what we can do with such a structure. Let me show you the result of windbg symbols.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
</pre><td class="rouge-code"><pre><span class="n">kd</span><span class="o">&gt;</span> <span class="n">dt</span> <span class="n">nt</span><span class="o">!</span><span class="n">_KPRCB</span>
<span class="o">+</span><span class="mh">0x000</span> <span class="n">MxCsr</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x004</span> <span class="n">LegacyNumber</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x005</span> <span class="n">ReservedMustBeZero</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x006</span> <span class="n">InterruptRequest</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x007</span> <span class="n">IdleHalt</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x008</span> <span class="n">CurrentThread</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KTHREAD</span>
<span class="o">+</span><span class="mh">0x010</span> <span class="n">NextThread</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KTHREAD</span>
<span class="o">+</span><span class="mh">0x018</span> <span class="n">IdleThread</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KTHREAD</span>
<span class="o">+</span><span class="mh">0x020</span> <span class="n">NestingLevel</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x021</span> <span class="n">ClockOwner</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x022</span> <span class="n">PendingTickFlags</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x022</span> <span class="n">PendingTick</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x022</span> <span class="n">PendingBackupTick</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x023</span> <span class="n">IdleState</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x024</span> <span class="n">Number</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x028</span> <span class="n">RspBase</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x030</span> <span class="n">PrcbLock</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x038</span> <span class="n">PriorityState</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Char</span>
<span class="o">+</span><span class="mh">0x040</span> <span class="n">CpuType</span> <span class="o">:</span> <span class="n">Char</span>
<span class="o">+</span><span class="mh">0x041</span> <span class="n">CpuID</span> <span class="o">:</span> <span class="n">Char</span>
<span class="o">+</span><span class="mh">0x042</span> <span class="n">CpuStep</span> <span class="o">:</span> <span class="n">Uint2B</span>
<span class="o">+</span><span class="mh">0x042</span> <span class="n">CpuStepping</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x043</span> <span class="n">CpuModel</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x044</span> <span class="n">MHz</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x048</span> <span class="n">HalReserved</span> <span class="o">:</span> <span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x088</span> <span class="n">MinorVersion</span> <span class="o">:</span> <span class="n">Uint2B</span>
<span class="o">+</span><span class="mh">0x08a</span> <span class="n">MajorVersion</span> <span class="o">:</span> <span class="n">Uint2B</span>
<span class="o">+</span><span class="mh">0x08c</span> <span class="n">BuildType</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x08d</span> <span class="n">CpuVendor</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x08e</span> <span class="n">CoresPerPhysicalProcessor</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x08f</span> <span class="n">LogicalProcessorsPerCore</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x090</span> <span class="n">PrcbPad04</span> <span class="o">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x0c0</span> <span class="n">ParentNode</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KNODE</span>
<span class="o">+</span><span class="mh">0x0c8</span> <span class="n">GroupSetMember</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x0d0</span> <span class="n">Group</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x0d1</span> <span class="n">GroupIndex</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x0d2</span> <span class="n">PrcbPad05</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x0d4</span> <span class="n">InitialApicId</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0d8</span> <span class="n">ScbOffset</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0dc</span> <span class="n">ApicMask</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0e0</span> <span class="n">AcpiReserved</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x0e8</span> <span class="n">CFlushSize</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0ec</span> <span class="n">PrcbPad10</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x0f0</span> <span class="n">PrcbPad11</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x100</span> <span class="n">ProcessorState</span> <span class="o">:</span> <span class="n">_KPROCESSOR_STATE</span>
<span class="o">+</span><span class="mh">0x6c0</span> <span class="n">PrcbPad12</span> <span class="o">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x6f0</span> <span class="n">LockQueue</span> <span class="o">:</span> <span class="p">[</span><span class="mi">17</span><span class="p">]</span> <span class="n">_KSPIN_LOCK_QUEUE</span>
<span class="o">+</span><span class="mh">0x800</span> <span class="n">PPLookasideList</span> <span class="o">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="n">_PP_LOOKASIDE_LIST</span>
<span class="o">+</span><span class="mh">0x900</span> <span class="n">PPNxPagedLookasideList</span> <span class="o">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">_GENERAL_LOOKASIDE_POOL</span>
<span class="o">+</span><span class="mh">0x1500</span> <span class="n">PPNPagedLookasideList</span> <span class="o">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">_GENERAL_LOOKASIDE_POOL</span>
<span class="o">+</span><span class="mh">0x2100</span> <span class="n">PPPagedLookasideList</span> <span class="o">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">_GENERAL_LOOKASIDE_POOL</span>
<span class="o">+</span><span class="mh">0x2d00</span> <span class="n">PrcbPad20</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x2d08</span> <span class="n">DeferredReadyListHead</span> <span class="o">:</span> <span class="n">_SINGLE_LIST_ENTRY</span>
<span class="o">+</span><span class="mh">0x2d10</span> <span class="n">MmPageFaultCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d14</span> <span class="n">MmCopyOnWriteCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d18</span> <span class="n">MmTransitionCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d1c</span> <span class="n">MmDemandZeroCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d20</span> <span class="n">MmPageReadCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d24</span> <span class="n">MmPageReadIoCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d28</span> <span class="n">MmDirtyPagesWriteCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d2c</span> <span class="n">MmDirtyWriteIoCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d30</span> <span class="n">MmMappedPagesWriteCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d34</span> <span class="n">MmMappedWriteIoCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d38</span> <span class="n">KeSystemCalls</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d3c</span> <span class="n">KeContextSwitches</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d40</span> <span class="n">PrcbPad40</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d44</span> <span class="n">CcFastReadNoWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d48</span> <span class="n">CcFastReadWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d4c</span> <span class="n">CcFastReadNotPossible</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d50</span> <span class="n">CcCopyReadNoWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d54</span> <span class="n">CcCopyReadWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d58</span> <span class="n">CcCopyReadNoWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d5c</span> <span class="n">IoReadOperationCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d60</span> <span class="n">IoWriteOperationCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d64</span> <span class="n">IoOtherOperationCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d68</span> <span class="n">IoReadTransferCount</span> <span class="o">:</span> <span class="n">_LARGE_INTEGER</span>
<span class="o">+</span><span class="mh">0x2d70</span> <span class="n">IoWriteTransferCount</span> <span class="o">:</span> <span class="n">_LARGE_INTEGER</span>
<span class="o">+</span><span class="mh">0x2d78</span> <span class="n">IoOtherTransferCount</span> <span class="o">:</span> <span class="n">_LARGE_INTEGER</span>
<span class="o">+</span><span class="mh">0x2d80</span> <span class="n">PacketBarrier</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d84</span> <span class="n">TargetCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2d88</span> <span class="n">IpiFrozen</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d90</span> <span class="n">IsrDpcStats</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x2d98</span> <span class="n">DeviceInterrupts</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2d9c</span> <span class="n">LookasideIrpFloat</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2da0</span> <span class="n">InterruptLastCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2da4</span> <span class="n">InterruptRate</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2da8</span> <span class="n">LastNonHrTimerExpiration</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x2db0</span> <span class="n">PrcbPad41</span> <span class="o">:</span> <span class="p">[</span><span class="mi">20</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e00</span> <span class="n">DpcData</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">_KDPC_DATA</span>
<span class="o">+</span><span class="mh">0x2e50</span> <span class="n">DpcStack</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x2e58</span> <span class="n">MaximumDpcQueueDepth</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2e5c</span> <span class="n">DpcRequestRate</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e60</span> <span class="n">MinimumDpcRate</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e64</span> <span class="n">DpcLastCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e68</span> <span class="n">ThreadDpcEnable</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x2e69</span> <span class="n">QuantumEnd</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x2e6a</span> <span class="n">DpcRoutineActive</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x2e6b</span> <span class="n">IdleSchedule</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcRequestSummary</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcRequestSlot</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Int2B</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">NormalDpcState</span> <span class="o">:</span> <span class="n">Int2B</span>
<span class="o">+</span><span class="mh">0x2e6e</span> <span class="n">ThreadDpcState</span> <span class="o">:</span> <span class="n">Int2B</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalProcessingActive</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalProcessingRequested</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalThreadSignal</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalTimerExpiration</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalDpcPresent</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalLocalInterrupt</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcNormalSpare</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">10</span> <span class="n">Bits</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcThreadActive</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcThreadRequested</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">1</span> <span class="n">Bit</span>
<span class="o">+</span><span class="mh">0x2e6c</span> <span class="n">DpcThreadSpare</span> <span class="o">:</span> <span class="n">Pos</span> <span class="mi">18</span><span class="p">,</span> <span class="mi">14</span> <span class="n">Bits</span>
<span class="o">+</span><span class="mh">0x2e70</span> <span class="n">LastTimerHand</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e74</span> <span class="n">LastTick</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e78</span> <span class="n">ClockInterrupts</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e7c</span> <span class="n">ReadyScanTick</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x2e80</span> <span class="n">InterruptObject</span> <span class="o">:</span> <span class="p">[</span><span class="mi">256</span><span class="p">]</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x3680</span> <span class="n">TimerTable</span> <span class="o">:</span> <span class="n">_KTIMER_TABLE</span>
<span class="o">+</span><span class="mh">0x5880</span> <span class="n">DpcGate</span> <span class="o">:</span> <span class="n">_KGATE</span>
<span class="o">+</span><span class="mh">0x5898</span> <span class="n">PrcbPad52</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x58a0</span> <span class="n">CallDpc</span> <span class="o">:</span> <span class="n">_KDPC</span>
<span class="o">+</span><span class="mh">0x58e0</span> <span class="n">ClockKeepAlive</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x58e4</span> <span class="n">PrcbPad60</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x58e6</span> <span class="n">NmiActive</span> <span class="o">:</span> <span class="n">Uint2B</span>
<span class="o">+</span><span class="mh">0x58e8</span> <span class="n">DpcWatchdogPeriod</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x58ec</span> <span class="n">DpcWatchdogCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x58f0</span> <span class="n">KeSpinLockOrdering</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x58f4</span> <span class="n">DpcWatchdogProfileCumulativeDpcThreshold</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x58f8</span> <span class="n">CachedPtes</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x5900</span> <span class="n">WaitListHead</span> <span class="o">:</span> <span class="n">_LIST_ENTRY</span>
<span class="o">+</span><span class="mh">0x5910</span> <span class="n">WaitLock</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5918</span> <span class="n">ReadySummary</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x591c</span> <span class="n">AffinitizedSelectionMask</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x5920</span> <span class="n">QueueIndex</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5924</span> <span class="n">PrcbPad75</span> <span class="o">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5930</span> <span class="n">TimerExpirationDpc</span> <span class="o">:</span> <span class="n">_KDPC</span>
<span class="o">+</span><span class="mh">0x5970</span> <span class="n">ScbQueue</span> <span class="o">:</span> <span class="n">_RTL_RB_TREE</span>
<span class="o">+</span><span class="mh">0x5980</span> <span class="n">DispatcherReadyListHead</span> <span class="o">:</span> <span class="p">[</span><span class="mi">32</span><span class="p">]</span> <span class="n">_LIST_ENTRY</span>
<span class="o">+</span><span class="mh">0x5b80</span> <span class="n">InterruptCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5b84</span> <span class="n">KernelTime</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5b88</span> <span class="n">UserTime</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5b8c</span> <span class="n">DpcTime</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5b90</span> <span class="n">InterruptTime</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5b94</span> <span class="n">AdjustDpcThreshold</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5b98</span> <span class="n">DebuggerSavedIRQL</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x5b99</span> <span class="n">GroupSchedulingOverQuota</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x5b9a</span> <span class="n">DeepSleep</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x5b9b</span> <span class="n">PrcbPad80</span> <span class="o">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x5ba0</span> <span class="n">DpcTimeCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5ba4</span> <span class="n">DpcTimeLimit</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5ba8</span> <span class="n">PeriodicCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5bac</span> <span class="n">PeriodicBias</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5bb0</span> <span class="n">AvailableTime</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5bb4</span> <span class="n">KeExceptionDispatchCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5bb8</span> <span class="n">ReadyThreadCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5bc0</span> <span class="n">StartCycles</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5bc8</span> <span class="n">TaggedCyclesStart</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5bd0</span> <span class="n">TaggedCycles</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5be0</span> <span class="n">GenerationTarget</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5be8</span> <span class="n">AffinitizedCycles</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5bf0</span> <span class="n">ImportantCycles</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5bf8</span> <span class="n">UnimportantCycles</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5c00</span> <span class="n">ReadyQueueExpectedRunTime</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5c08</span> <span class="n">PrcbPad81</span> <span class="o">:</span> <span class="p">[</span><span class="mi">21</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c5c</span> <span class="n">DpcWatchdogProfileSingleDpcThreshold</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c60</span> <span class="n">MmSpinLockOrdering</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x5c64</span> <span class="n">PageColor</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c68</span> <span class="n">NodeColor</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c6c</span> <span class="n">NodeShiftedColor</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c70</span> <span class="n">SecondaryColorMask</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c74</span> <span class="n">PrcbPad83</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5c78</span> <span class="n">CycleTime</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5c80</span> <span class="n">Cycles</span> <span class="o">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x5cc0</span> <span class="n">PrcbPad84</span> <span class="o">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d00</span> <span class="n">CcFastMdlReadNoWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d04</span> <span class="n">CcFastMdlReadWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d08</span> <span class="n">CcFastMdlReadNotPossible</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d0c</span> <span class="n">CcMapDataNoWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d10</span> <span class="n">CcMapDataWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d14</span> <span class="n">CcPinMappedDataCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d18</span> <span class="n">CcPinReadNoWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d1c</span> <span class="n">CcPinReadWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d20</span> <span class="n">CcMdlReadNoWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d24</span> <span class="n">CcMdlReadWait</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d28</span> <span class="n">CcLazyWriteHotSpots</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d2c</span> <span class="n">CcLazyWriteIos</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d30</span> <span class="n">CcLazyWritePages</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d34</span> <span class="n">CcDataFlushes</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d38</span> <span class="n">CcDataPages</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d3c</span> <span class="n">CcLostDelayedWrites</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d40</span> <span class="n">CcFastReadResourceMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d44</span> <span class="n">CcCopyReadWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d48</span> <span class="n">CcFastMdlReadResourceMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d4c</span> <span class="n">CcMapDataNoWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d50</span> <span class="n">CcMapDataWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d54</span> <span class="n">CcPinReadNoWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d58</span> <span class="n">CcPinReadWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d5c</span> <span class="n">CcMdlReadNoWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d60</span> <span class="n">CcMdlReadWaitMiss</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d64</span> <span class="n">CcReadAheadIos</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d68</span> <span class="n">MmCacheTransitionCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x5d6c</span> <span class="n">MmCacheReadCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x5d70</span> <span class="n">MmCacheIoCount</span> <span class="o">:</span> <span class="n">Int4B</span>
<span class="o">+</span><span class="mh">0x5d74</span> <span class="n">PrcbPad91</span> <span class="o">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5d80</span> <span class="n">PowerState</span> <span class="o">:</span> <span class="n">_PROCESSOR_POWER_STATE</span>
<span class="o">+</span><span class="mh">0x5f58</span> <span class="n">ScbList</span> <span class="o">:</span> <span class="n">_LIST_ENTRY</span>
<span class="o">+</span><span class="mh">0x5f68</span> <span class="n">ForceIdleDpc</span> <span class="o">:</span> <span class="n">_KDPC</span>
<span class="o">+</span><span class="mh">0x5fa8</span> <span class="n">PrcbPad92</span> <span class="o">:</span> <span class="p">[</span><span class="mi">18</span><span class="p">]</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5ff0</span> <span class="n">KeAlignmentFixupCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x5ff8</span> <span class="n">DpcWatchdogDpc</span> <span class="o">:</span> <span class="n">_KDPC</span>
<span class="o">+</span><span class="mh">0x6038</span> <span class="n">DpcWatchdogTimer</span> <span class="o">:</span> <span class="n">_KTIMER</span>
<span class="o">+</span><span class="mh">0x6078</span> <span class="n">Cache</span> <span class="o">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">_CACHE_DESCRIPTOR</span>
<span class="o">+</span><span class="mh">0x60b4</span> <span class="n">CacheCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x60b8</span> <span class="n">CachedCommit</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x60bc</span> <span class="n">CachedResidentAvailable</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x60c0</span> <span class="n">HyperPte</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x60c8</span> <span class="n">WheaInfo</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x60d0</span> <span class="n">EtwSupport</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x60e0</span> <span class="n">InterruptObjectPool</span> <span class="o">:</span> <span class="n">_SLIST_HEADER</span>
<span class="o">+</span><span class="mh">0x60f0</span> <span class="n">HypercallPageList</span> <span class="o">:</span> <span class="n">_SLIST_HEADER</span>
<span class="o">+</span><span class="mh">0x6100</span> <span class="n">HypercallCachedPages</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x6108</span> <span class="n">VirtualApicAssist</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x6110</span> <span class="n">StatisticsPage</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x6118</span> <span class="n">PackageProcessorSet</span> <span class="o">:</span> <span class="n">_KAFFINITY_EX</span>
<span class="o">+</span><span class="mh">0x61c0</span> <span class="n">SharedReadyQueueMask</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x61c8</span> <span class="n">SharedReadyQueue</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_KSHARED_READY_QUEUE</span>
<span class="o">+</span><span class="mh">0x61d0</span> <span class="n">SharedQueueScanOwner</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x61d4</span> <span class="n">ScanSiblingIndex</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x61d8</span> <span class="n">CoreProcessorSet</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x61e0</span> <span class="n">ScanSiblingMask</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x61e8</span> <span class="n">LLCMask</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x61f0</span> <span class="n">CacheProcessorMask</span> <span class="o">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x6218</span> <span class="n">ProcessorProfileControlArea</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_PROCESSOR_PROFILE_CONTROL_AREA</span>
<span class="o">+</span><span class="mh">0x6220</span> <span class="n">ProfileEventIndexAddress</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x6228</span> <span class="n">DpcWatchdogProfile</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x6230</span> <span class="n">DpcWatchdogProfileCurrentEmptyCapture</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x6238</span> <span class="n">PrcbPad94</span> <span class="o">:</span> <span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x6280</span> <span class="n">SynchCounters</span> <span class="o">:</span> <span class="n">_SYNCH_COUNTERS</span>
<span class="o">+</span><span class="mh">0x6338</span> <span class="n">PteBitCache</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x6340</span> <span class="n">PteBitOffset</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x6348</span> <span class="n">FsCounters</span> <span class="o">:</span> <span class="n">_FILESYSTEM_DISK_COUNTERS</span>
<span class="o">+</span><span class="mh">0x6358</span> <span class="n">VendorString</span> <span class="o">:</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x6365</span> <span class="n">PrcbPad100</span> <span class="o">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x6367</span> <span class="n">PendingVirtualLittle</span> <span class="o">:</span> <span class="n">UChar</span>
<span class="o">+</span><span class="mh">0x6368</span> <span class="n">FeatureBits</span> <span class="o">:</span> <span class="n">Uint8B</span>
<span class="o">+</span><span class="mh">0x6370</span> <span class="n">PrcbPad110</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x6378</span> <span class="n">UpdateSignature</span> <span class="o">:</span> <span class="n">_LARGE_INTEGER</span>
<span class="o">+</span><span class="mh">0x6380</span> <span class="n">Context</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_CONTEXT</span>
<span class="o">+</span><span class="mh">0x6388</span> <span class="n">ContextFlagsInit</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x6390</span> <span class="n">ExtendedState</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_XSAVE_AREA</span>
<span class="o">+</span><span class="mh">0x6398</span> <span class="n">IsrStack</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x63a0</span> <span class="n">EntropyTimingState</span> <span class="o">:</span> <span class="n">_KENTROPY_TIMING_STATE</span>
<span class="o">+</span><span class="mh">0x64f0</span> <span class="n">AbSelfIoBoostsList</span> <span class="o">:</span> <span class="n">_SINGLE_LIST_ENTRY</span>
<span class="o">+</span><span class="mh">0x64f8</span> <span class="n">AbPropagateBoostsList</span> <span class="o">:</span> <span class="n">_SINGLE_LIST_ENTRY</span>
<span class="o">+</span><span class="mh">0x6500</span> <span class="n">AbDpc</span> <span class="o">:</span> <span class="n">_KDPC</span>
<span class="o">+</span><span class="mh">0x6540</span> <span class="n">IoIrpStackProfilerCurrent</span> <span class="o">:</span> <span class="n">_IOP_IRP_STACK_PROFILER</span>
<span class="o">+</span><span class="mh">0x6594</span> <span class="n">IoIrpStackProfilerPrevious</span> <span class="o">:</span> <span class="n">_IOP_IRP_STACK_PROFILER</span>
<span class="o">+</span><span class="mh">0x6600</span> <span class="n">LocalSharedReadyQueue</span> <span class="o">:</span> <span class="n">_KSHARED_READY_QUEUE</span>
<span class="o">+</span><span class="mh">0x6870</span> <span class="n">TimerExpirationTrace</span> <span class="o">:</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span> <span class="n">_KTIMER_EXPIRATION_TRACE</span>
<span class="o">+</span><span class="mh">0x6970</span> <span class="n">TimerExpirationTraceCount</span> <span class="o">:</span> <span class="n">Uint4B</span>
<span class="o">+</span><span class="mh">0x6978</span> <span class="n">ExSaPageArray</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">Void</span>
<span class="o">+</span><span class="mh">0x6980</span> <span class="n">SecureFault</span> <span class="o">:</span> <span class="n">_KSECURE_FAULT_INFORMATION</span>
<span class="o">+</span><span class="mh">0x69c0</span> <span class="n">Mailbox</span> <span class="o">:</span> <span class="n">Ptr64</span> <span class="n">_REQUEST_MAILBOX</span>
<span class="o">+</span><span class="mh">0x6a00</span> <span class="n">RequestMailbox</span> <span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">_REQUEST_MAILBOX</span>
</pre></table></code></div></div><p>Looking at the above structure shows a lot of great information about the system processor.You can find something like Current and Next Thread _KTHREAD, all information about CPU like type and capacity and manufacture company, DPC, Cycles, User-mode and Kernel-mode times and etc.</p><p>By the way, you now know that windows stores some of its internal information about CPU in nt!_PRCB and you should know find where this structure is located, I’m running an AMD64 version of Windows so it’s time to use gs:[0] in order to get the location of nt!_KPCR structure.</p><p>By using the following command you can get gs:[0] values :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dq</span> <span class="n">gs</span><span class="o">:</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></table></code></div></div><p>you can also use !pcr which gives you almost the same result :)</p><p><img data-src="../../assets/images/kpcr-structure.png" alt="" data-proofer-ignore></p><p>So, now we have where the _KPCR is located and now we should simply use :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">dt</span><span class="err"> </span><span class="o">&lt;</span><span class="n">Address</span><span class="o">&gt;</span> <span class="n">nt</span><span class="o">!</span><span class="n">_KPCR</span>
</pre></table></code></div></div><p>And after finding the pcrb now we should use dt in order to map the result into the _kpcrb structure.</p><p><img data-src="../../assets/images/kprcb-structure.png" alt="" data-proofer-ignore></p><p> </p><p>If you want to be sure that you are in a right place you can search for Vendor string as follows :</p><p><img data-src="../../assets/images/hypervisor-vendor-string.png" alt="" data-proofer-ignore></p><p> </p><p>It gives you kinds of hex which is equal to “GenuineIntel” and this is, of course, my CPU vendor.</p><p> </p><p><img data-src="../../assets/images/hypervisor-vendor-string-ascii.png" alt="" data-proofer-ignore></p><p> </p><p>After this, we know that we are in a right place so let see other fields in order to find something interesting!</p><p>After studying this structure now I see something that is so familiar to me and that is “Mhz”.</p><p><img data-src="../../assets/images/Mhz-field-in-windows.png" alt="" data-proofer-ignore></p><p> </p><p>Can you see my CPU’s Mhz value ?!  Let me see my windows properties.</p><p> </p><p><img data-src="../../assets/images/vm-properties-1.png" alt="" data-proofer-ignore></p><p> </p><p>Ok, this is what we see previously, Doesn’t it ?!</p><p><img data-src="../../assets/images/calc-hex-computation.png" alt="" data-proofer-ignore></p><p> </p><p>This value (2.71 GHz) exactly equals to 0xA98 so changing this value must be interesting.</p><p>I find this value and changing it to 0x10 which is equal to 16 in decimal.</p><p><img data-src="../../assets/images/processor-Mhz-value.png" alt="" data-proofer-ignore></p><p> </p><p>So we modified the value from 0x98 to 0x10 and now we want to see if it takes effect in system information or not, so let’s view system properties again.</p><p><img data-src="../../assets/images/vm-properties-2.png" alt="" data-proofer-ignore></p><p> </p><p>That’s it, guys!</p><p>You can see we changed windows properties and now it says that you have a 16 Mhz CPU.Of course, this was an example of what we can do with prcb and it doesn’t affect on windows but you can do many other things by modifying this structure like changing threads or block a thread but keep in mind that editing this structure in a wrong way almost always causes the Blue Screen Of Dead.</p><p>Thanks for reading.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/debugging/'>debugging</a>, <a href='/categories/kernel-mode/'>kernel-mode</a>, <a href='/categories/windows/'>windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/change-cpu/" class="post-tag no-text-decoration" >change-cpu</a> <a href="/tags/change-kernel/" class="post-tag no-text-decoration" >change-kernel</a> <a href="/tags/edit-windows-internals/" class="post-tag no-text-decoration" >edit-windows-internals</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Fooling Windows about its internal CPU - Rayanfam Blog&amp;url=https://rayanfam.com/topics/fooling-windows-about-cpu/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Fooling Windows about its internal CPU - Rayanfam Blog&amp;u=https://rayanfam.com/topics/fooling-windows-about-cpu/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://rayanfam.com/topics/fooling-windows-about-cpu/&amp;text=Fooling Windows about its internal CPU - Rayanfam Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/topics/hypervisor-from-scratch-part-1/">Hypervisor From Scratch - Part 1: Basic Concepts & Configure Testing Environment</a><li><a href="/topics/hypervisor-from-scratch-part-2/">Hypervisor From Scratch – Part 2: Entering VMX Operation</a><li><a href="/topics/hypervisor-from-scratch-part-5/">Hypervisor From Scratch – Part 5: Setting up VMCS & Running Guest Code</a><li><a href="/topics/hypervisor-from-scratch-part-6/">Hypervisor From Scratch – Part 6: Virtualizing An Already Running System</a><li><a href="/topics/hypervisor-from-scratch-part-7/">Hypervisor From Scratch – Part 7: Using EPT & Page-Level Monitoring Features</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hypervisor/">hypervisor</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/cisco/">cisco</a> <a class="post-tag" href="/tags/invept/">invept</a> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/vmcs/">vmcs</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/cache/">cache</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/topics/finding-the-real-access-rights-needed-by-handles/"><div class="card-body"> <em class="timeago small" data-ts="1559779200" > 2019-06-06 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Why you should not always trust MSDN: Finding Real Access Rights Needed By Handles</h3><div class="text-muted small"><p> Introduction Hi guys, The title of this topic is somehow weird, if you think everything in MSDN is 100% match with what Microsoft implemented in Windows (like what I used to think), you’re defi...</p></div></div></a></div><div class="card"> <a href="/topics/pykd-tutorial-part1/"><div class="card-body"> <em class="timeago small" data-ts="1527206400" > 2018-05-25 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>PyKD Tutorial - part 1</h3><div class="text-muted small"><p> Using windbg script syntax is such annoying thing that almost all reverse engineers have problems dealing with it but automating debugging gives such a power that can’t be easily ignored. A good ...</p></div></div></a></div><div class="card"> <a href="/topics/inside-windows-page-frame-number-part1/"><div class="card-body"> <em class="timeago small" data-ts="1531958400" > 2018-07-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Inside Windows Page Frame Number (PFN) - Part 1</h3><div class="text-muted small"><p> Introduction (Page Frame Number) Windows and almost all the OSs use Page Frame Number Database in order to have a track of virtually allocated pages to know which page must be freed or evicted o...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/topics/simple-openldap-phpldapadmin-setup/" class="btn btn-outline-primary" prompt="Older"><p>Simple OpenLDAP + phpLDAPadmin setup</p></a> <a href="/topics/get-everything-from-net-reflection-by-two-method/" class="btn btn-outline-primary" prompt="Newer"><p>Get everything from .Net Reflection</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://rayanfam.com/topics/fooling-windows-about-cpu/'; this.page.identifier = '/topics/fooling-windows-about-cpu/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://rayanfam.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/rayanfam">Rayanfam Blog</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hypervisor/">hypervisor</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/cisco/">cisco</a> <a class="post-tag" href="/tags/invept/">invept</a> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/vmcs/">vmcs</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/cache/">cache</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-P6M1BDG57Z"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-P6M1BDG57Z'); }); </script>
