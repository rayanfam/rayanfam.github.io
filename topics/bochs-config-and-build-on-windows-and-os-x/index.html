<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Bochs Emulator - Config &amp; Build on Windows and OS X" /><meta name="author" content="Sina Karvandi" /><meta property="og:locale" content="en" /><meta name="description" content="We write about Windows Internals, Hypervisors, Linux, and Networks." /><meta property="og:description" content="We write about Windows Internals, Hypervisors, Linux, and Networks." /><link rel="canonical" href="https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/" /><meta property="og:url" content="https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/" /><meta property="og:site_name" content="Rayanfam Blog" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2018-04-18T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Bochs Emulator - Config &amp; Build on Windows and OS X" /><meta name="twitter:site" content="@Intel80x86" /><meta name="twitter:creator" content="@Sina Karvandi" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sina Karvandi"},"dateModified":"2024-07-13T12:45:21+00:00","datePublished":"2018-04-18T00:00:00+00:00","description":"We write about Windows Internals, Hypervisors, Linux, and Networks.","headline":"Bochs Emulator - Config &amp; Build on Windows and OS X","mainEntityOfPage":{"@type":"WebPage","@id":"https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/"},"url":"https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/"}</script><title>Bochs Emulator - Config & Build on Windows and OS X | Rayanfam Blog</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rayanfam Blog"><meta name="application-name" content="Rayanfam Blog"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/images/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rayanfam Blog</a></div><div class="site-subtitle font-italic">An aggressive out-of-order, superscalar blog...</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/tutorials/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>TUTORIALS</span> </a><li class="nav-item"> <a href="/tools/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>TOOLS & SCRIPTS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/contact/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>CONTACT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/rayanfam" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/Intel80x86" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sina','rayanfam.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Bochs Emulator - Config & Build on Windows and OS X</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Bochs Emulator - Config & Build on Windows and OS X</h1><div class="post-meta text-muted"><div> By <em> <a href="https://twitter.com/Intel80x86">Sina Karvandi</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1524009600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2018-04-18 </em> </span> <span> Updated <em class="timeago" data-ts="1720874721" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-07-13 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2514 words"> <em>13 min</em> read</span></div></div></div><div class="post-content"><p><img data-src="../../assets/images/bochs-cover.png" alt="" data-proofer-ignore></p><h2 id="introduction"><span class="mr-2">Introduction</span><a href="#introduction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Bochs is an x86 - x86-64 multiplatform emulator that provides emulation of CPU Instruction Fetching without using Hypervisor technologies like Intel’s VT-x and AMD-V.</p><p>One of the benefits of emulation rather than virtualization is that you can execute instructions of old discontinued CPU structures in modern CPU or run Intel’s instructions on an AMD CPU or vice versa, more than that Bochs developers try to make Bochs devices like virtualization software devices.They provide keyboard, speaker, cdrom, disk, floppy, network device and etc.</p><p>Emulation is somehow like high-level programming languages like Java when using its bytecode or .Net Framework when using MSIL.</p><p>From IBM :</p><blockquote><p>Java technology implements just-in-time (JIT) compilation to work around some of the inefficiencies, similar to Transmeta and numerous other emulation solutions (including QEMU, another platform emulation solution similar to Bochs). But Bochs also achieves efficient emulation (up to 100 million instructions per second [MIPS] on a modern processor) while also being portable. Bochs was developed purely in the <code class="language-c highlighter-rouge"><span class="n">C</span><span class="o">++</span></code> language for interpreted x86 instruction execution and platform emulation.</p></blockquote><p><img data-src="../../assets/images/bochs-log.gif" alt="Bochs" data-proofer-ignore></p><p> </p><p>Because of instructions doesn’t directly execute on a Bochs machine, It is too much slower than CPU on virtualization so Bochs comes at the cost of performance.</p><p>Even though Bochs is really slow but it gives us other benefits that worths using the emulator like Instrumenting an operating system kernel which I described in <a href="http://rayanfam.com/topics/bochs-emulator-debug-and-instrument/">Bochs Emulator - Debug &amp; Instrument</a>.</p><p>Bochs is an open-source program and in order to use some features like instrumentation and other optimization you need to compile it by your self, more than that you can edit the source code for researching because Bochs have lots of cool features that can be manipulated in order to better optimize your needs, so I prefer to compile it rather than downloading its binaries.</p><p>ok, that’s enough for introduction, let’s see how to “make” it!</p><p><strong>In the rest of topic, I’m trying to build bochs-2.9.</strong></p><h2 id="configure--make-in-os-x"><span class="mr-2">Configure &amp; Make in OS X</span><a href="#configure--make-in-os-x" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>First, you need to download the project source code, you can find it <a href="https://github.com/dariaphoebe/bochs">here.</a></p><p>The <a href="http://bochs.sourceforge.net/doc/docbook/user/compiling.html">documentation</a> uses the following syntax in order to build the Bochs on OS X machines</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">.</span><span class="o">/</span><span class="n">configure</span>
<span class="n">make</span>
</pre></table></code></div></div><p>But it gives me the following error after running “make”:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="n">Sinas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="o">:</span><span class="n">bochs</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span> <span class="n">sina</span><span class="err">$</span> <span class="n">make</span>
<span class="n">cd</span> <span class="n">iodev</span> <span class="o">&amp;&amp;</span> \
	<span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Developer</span><span class="o">/</span><span class="n">CommandLineTools</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">make</span>  <span class="n">libiodev</span><span class="p">.</span><span class="n">a</span>
<span class="n">g</span><span class="o">++</span> <span class="o">-</span><span class="n">c</span>  <span class="o">-</span><span class="n">I</span><span class="p">..</span> <span class="o">-</span><span class="n">I</span><span class="p">.</span><span class="o">/</span><span class="p">..</span> <span class="o">-</span><span class="n">I</span><span class="p">..</span><span class="o">/</span><span class="n">instrument</span><span class="o">/</span><span class="n">stubs</span> <span class="o">-</span><span class="n">I</span><span class="p">.</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="n">instrument</span><span class="o">/</span><span class="n">stubs</span>  <span class="o">-</span><span class="n">fpascal</span><span class="o">-</span><span class="n">strings</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">common</span> <span class="o">-</span><span class="n">Wno</span><span class="o">-</span><span class="n">four</span><span class="o">-</span><span class="kt">char</span><span class="o">-</span><span class="n">constants</span> <span class="o">-</span><span class="n">Wno</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">pragmas</span> <span class="o">-</span><span class="n">Dmacintosh</span> <span class="o">-</span><span class="n">D_FILE_OFFSET_BITS</span><span class="o">=</span><span class="mi">64</span> <span class="o">-</span><span class="n">D_LARGE_FILES</span>    <span class="n">devices</span><span class="p">.</span><span class="n">cc</span> <span class="o">-</span><span class="n">o</span> <span class="n">devices</span><span class="p">.</span><span class="n">o</span>

<span class="p">...</span>

<span class="n">cdrom_osx</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">194</span><span class="o">:</span><span class="mi">18</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">assigning</span> <span class="n">to</span> <span class="err">'</span><span class="kt">char</span> <span class="o">*</span><span class="err">'</span> <span class="n">from</span> <span class="n">incompatible</span> <span class="n">type</span>
      <span class="err">'</span><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="err">'</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">devname</span> <span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span><span class="n">devpath</span><span class="p">,</span> <span class="sc">'/'</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
                 <span class="o">^~~~~~~~~~~~~~~~~~~~~</span>
<span class="n">cdrom_osx</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">231</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span> <span class="n">warning</span><span class="o">:</span> <span class="n">comparison</span> <span class="n">between</span> <span class="nb">NULL</span> <span class="n">and</span> <span class="n">non</span><span class="o">-</span><span class="n">pointer</span>
      <span class="p">(</span><span class="err">'</span><span class="n">io_registry_entry_t</span><span class="err">'</span> <span class="p">(</span><span class="n">aka</span> <span class="err">'</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="err">'</span><span class="p">)</span> <span class="n">and</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">[</span><span class="o">-</span><span class="n">Wnull</span><span class="o">-</span><span class="n">arithmetic</span><span class="p">]</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">service</span> <span class="o">==</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
      <span class="o">~~~~~~~</span> <span class="o">^</span>  <span class="o">~~~~</span>
<span class="n">cdrom_osx</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">291</span><span class="o">:</span><span class="mi">30</span><span class="o">:</span> <span class="n">warning</span><span class="o">:</span> <span class="n">implicit</span> <span class="n">conversion</span> <span class="n">of</span> <span class="nb">NULL</span> <span class="n">constant</span> <span class="n">to</span>
      <span class="err">'</span><span class="n">mach_port_t</span><span class="err">'</span> <span class="p">(</span><span class="n">aka</span> <span class="err">'</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="err">'</span><span class="p">)</span> <span class="p">[</span><span class="o">-</span><span class="n">Wnull</span><span class="o">-</span><span class="n">conversion</span><span class="p">]</span>
    <span class="n">mach_port_t</span> <span class="n">masterPort</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
                <span class="o">~~~~~~~~~~</span>   <span class="o">^~~~</span>
                             <span class="mi">0</span>
<span class="mi">4</span> <span class="n">warnings</span> <span class="n">and</span> <span class="mi">1</span> <span class="n">error</span> <span class="n">generated</span><span class="p">.</span>
<span class="n">make</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="o">***</span> <span class="p">[</span><span class="n">cdrom_osx</span><span class="p">.</span><span class="n">o</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">1</span>
<span class="nl">make:</span> <span class="o">***</span> <span class="p">[</span><span class="n">iodev</span><span class="o">/</span><span class="n">hdimage</span><span class="o">/</span><span class="n">libhdimage</span><span class="p">.</span><span class="n">a</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">2</span>
</pre></table></code></div></div><p>that’s a weird error! I don’t know why this happens but I simply go to “cdrom_osx.cc” file and change the following line:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> <span class="k">if</span> <span class="p">((</span><span class="n">devname</span> <span class="o">=</span> <span class="n">strrchr</span><span class="p">(</span><span class="n">devpath</span><span class="p">,</span> <span class="sc">'/'</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</pre></table></code></div></div><p>to:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>  <span class="k">if</span> <span class="p">((</span><span class="n">devname</span> <span class="o">=</span> <span class="p">(</span><span class="kt">char</span><span class="o">*</span><span class="p">)</span><span class="n">strrchr</span><span class="p">(</span><span class="n">devpath</span><span class="p">,</span> <span class="sc">'/'</span><span class="p">))</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</pre></table></code></div></div><p>And simply ignore this problem.</p><p>Let’s “make” it again.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
</pre><td class="rouge-code"><pre><span class="n">Sinas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="o">:</span><span class="n">bochs</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span> <span class="n">sina</span><span class="err">$</span> 

<span class="p">...</span>

<span class="n">Sinas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="o">:</span><span class="n">bochs</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span> <span class="n">sina</span><span class="err">$</span> 

<span class="p">...</span>

<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">155</span><span class="o">:</span><span class="mi">1</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">type</span> <span class="n">name</span> <span class="err">'</span><span class="n">CIconHandle</span><span class="err">'</span>
<span class="n">CIconHandle</span>     <span class="n">bx_cicn</span><span class="p">[</span><span class="n">BX_MAX_PIXMAPS</span><span class="p">];</span>
<span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">269</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">GetWindowPortBounds</span><span class="err">'</span>
  <span class="n">GetWindowPortBounds</span><span class="p">(</span><span class="n">myWindow</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">box</span><span class="p">);</span>
  <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">270</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">blackColor</span><span class="err">'</span>
  <span class="n">BackColor</span><span class="p">(</span><span class="n">blackColor</span><span class="p">);</span>
            <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">271</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">EraseRect</span><span class="err">'</span>
  <span class="n">EraseRect</span><span class="p">(</span><span class="o">&amp;</span><span class="n">box</span><span class="p">);</span>
  <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">310</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">GetWindowPortBounds</span><span class="err">'</span>
  <span class="n">GetWindowPortBounds</span><span class="p">(</span><span class="n">myWindow</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">box</span><span class="p">);</span>
  <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">401</span><span class="o">:</span><span class="mi">10</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">FindWindow</span><span class="err">'</span>
  <span class="n">part</span> <span class="o">=</span> <span class="n">FindWindow</span><span class="p">(</span><span class="n">wheresMyMouse</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">whichWindow</span><span class="p">);</span>
         <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">407</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">MenuSelect</span><span class="err">'</span>
    <span class="n">MenuSelect</span><span class="p">(</span><span class="n">wheresMyMouse</span><span class="p">);</span>
    <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">443</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">CreateStandardAlert</span><span class="err">'</span>
      <span class="n">CreateStandardAlert</span><span class="p">(</span>
      <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">450</span><span class="o">:</span><span class="mi">7</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">RunStandardAlert</span><span class="err">'</span>
      <span class="n">RunStandardAlert</span><span class="p">(</span>
      <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">474</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">IsWindowVisible</span><span class="err">'</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IsWindowVisible</span><span class="p">(</span><span class="n">toolwin</span><span class="p">))</span>
          <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">488</span><span class="o">:</span><span class="mi">11</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">IsWindowVisible</span><span class="err">'</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">IsWindowVisible</span><span class="p">(</span><span class="n">toolwin</span><span class="p">)</span> <span class="o">||</span> <span class="n">menubarVisible</span><span class="p">)</span>
          <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">492</span><span class="o">:</span><span class="mi">13</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">IsWindowVisible</span><span class="err">'</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">IsWindowVisible</span><span class="p">(</span><span class="n">toolwin</span><span class="p">))</span>
            <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">499</span><span class="o">:</span><span class="mi">14</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">IsWindowVisible</span><span class="err">'</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">IsWindowVisible</span><span class="p">(</span><span class="n">toolwin</span><span class="p">))</span>
             <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">535</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">StopAlert</span><span class="err">'</span>
  <span class="n">StopAlert</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
  <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">543</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">InitCursor</span><span class="err">'</span>
  <span class="n">InitCursor</span><span class="p">();</span>
  <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">553</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">no</span> <span class="n">matching</span> <span class="n">function</span> <span class="k">for</span> <span class="n">call</span> <span class="n">to</span> <span class="err">'</span><span class="n">NewAEEventHandlerUPP</span><span class="err">'</span>
    <span class="n">NewAEEventHandlerUPP</span><span class="p">(</span><span class="n">QuitAppleEventHandler</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
    <span class="o">^~~~~~~~~~~~~~~~~~~~</span>
<span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">CoreServices</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">AE</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Headers</span><span class="o">/</span><span class="n">AEDataModel</span><span class="p">.</span><span class="n">h</span><span class="o">:</span><span class="mi">2730</span><span class="o">:</span><span class="mi">65</span><span class="o">:</span> <span class="n">note</span><span class="o">:</span> 
      <span class="n">candidate</span> <span class="n">function</span> <span class="n">not</span> <span class="n">viable</span><span class="o">:</span> <span class="n">no</span> <span class="n">known</span> <span class="n">conversion</span> <span class="n">from</span> <span class="err">'</span><span class="n">OSErr</span> <span class="p">(</span><span class="k">const</span>
      <span class="n">AppleEvent</span> <span class="o">*</span><span class="p">,</span> <span class="n">AppleEvent</span> <span class="o">*</span><span class="p">,</span> <span class="n">SInt32</span><span class="p">)</span><span class="err">'</span> <span class="p">(</span><span class="n">aka</span> <span class="err">'</span><span class="kt">short</span> <span class="p">(</span><span class="k">const</span> <span class="n">AEDesc</span> <span class="o">*</span><span class="p">,</span> <span class="n">AEDesc</span>
      <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">)</span><span class="err">'</span><span class="p">)</span> <span class="n">to</span> <span class="err">'</span><span class="n">AEEventHandlerProcPtr</span><span class="err">'</span> <span class="p">(</span><span class="n">aka</span> <span class="err">'</span><span class="kt">short</span> <span class="p">(</span><span class="o">*</span><span class="p">)(</span><span class="k">const</span> <span class="n">AEDesc</span> <span class="o">*</span><span class="p">,</span>
      <span class="n">AEDesc</span> <span class="o">*</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="err">'</span><span class="p">)</span> <span class="k">for</span> <span class="mi">1</span><span class="n">st</span> <span class="n">argument</span>
    <span class="kr">inline</span> <span class="n">AEEventHandlerUPP</span>                                    <span class="n">NewAEEve</span><span class="p">...</span>
                                                                <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">555</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">warning</span><span class="o">:</span> <span class="err">'</span><span class="n">ExitToShell</span><span class="err">'</span> <span class="n">is</span> <span class="n">deprecated</span><span class="o">:</span> <span class="n">first</span> <span class="n">deprecated</span> <span class="n">in</span> <span class="n">macOS</span>
      <span class="mi">10</span><span class="p">.</span><span class="mi">9</span> <span class="p">[</span><span class="o">-</span><span class="n">Wdeprecated</span><span class="o">-</span><span class="n">declarations</span><span class="p">]</span>
    <span class="n">ExitToShell</span><span class="p">();</span>
    <span class="o">^</span>
<span class="o">/</span><span class="n">System</span><span class="o">/</span><span class="n">Library</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">ApplicationServices</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Frameworks</span><span class="o">/</span><span class="n">HIServices</span><span class="p">.</span><span class="n">framework</span><span class="o">/</span><span class="n">Headers</span><span class="o">/</span><span class="n">Processes</span><span class="p">.</span><span class="n">h</span><span class="o">:</span><span class="mi">725</span><span class="o">:</span><span class="mi">6</span><span class="o">:</span> <span class="n">note</span><span class="o">:</span> 
      <span class="err">'</span><span class="n">ExitToShell</span><span class="err">'</span> <span class="n">has</span> <span class="n">been</span> <span class="n">explicitly</span> <span class="n">marked</span> <span class="n">deprecated</span> <span class="n">here</span>
<span class="kt">void</span> <span class="nf">ExitToShell</span><span class="p">(</span> <span class="kt">void</span> <span class="p">)</span> <span class="n">__attribute__</span> <span class="p">((</span> <span class="n">__noreturn__</span> <span class="p">))</span>   <span class="n">AVAILABLE_MA</span><span class="p">...</span>
     <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">575</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">GetGWorld</span><span class="err">'</span>
    <span class="n">GetGWorld</span><span class="p">(</span><span class="o">&amp;</span><span class="n">savePort</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">saveDevice</span><span class="p">);</span>
    <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">605</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">keepLocal</span><span class="err">'</span>
      <span class="o">&amp;</span><span class="n">srcTileRect</span><span class="p">,</span> <span class="n">disp_bpp</span><span class="o">&gt;</span><span class="mi">8</span> <span class="o">?</span> <span class="nb">NULL</span> <span class="o">:</span> <span class="n">gCTable</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="n">keepLocal</span><span class="p">,</span> <span class="n">gMyBuf</span><span class="p">...</span>
                                                       <span class="o">^</span>
<span class="n">carbon</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">609</span><span class="o">:</span><span class="mi">5</span><span class="o">:</span> <span class="n">error</span><span class="o">:</span> <span class="n">use</span> <span class="n">of</span> <span class="n">undeclared</span> <span class="n">identifier</span> <span class="err">'</span><span class="n">SetGWorld</span><span class="err">'</span>
    <span class="n">SetGWorld</span><span class="p">(</span><span class="n">gOffWorld</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
    <span class="o">^</span>
<span class="n">fatal</span> <span class="n">error</span><span class="o">:</span> <span class="n">too</span> <span class="n">many</span> <span class="n">errors</span> <span class="n">emitted</span><span class="p">,</span> <span class="n">stopping</span> <span class="n">now</span> <span class="p">[</span><span class="o">-</span><span class="n">ferror</span><span class="o">-</span><span class="n">limit</span><span class="o">=</span><span class="p">]</span>
<span class="mi">1</span> <span class="n">warning</span> <span class="n">and</span> <span class="mi">20</span> <span class="n">errors</span> <span class="n">generated</span><span class="p">.</span>
<span class="n">make</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="o">***</span> <span class="p">[</span><span class="n">carbon</span><span class="p">.</span><span class="n">o</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">1</span>
<span class="n">make</span><span class="o">:</span> <span class="o">***</span> <span class="p">[</span><span class="n">gui</span><span class="o">/</span><span class="n">libgui</span><span class="p">.</span><span class="n">a</span><span class="p">]</span> <span class="n">Error</span> <span class="mi">2</span>
</pre></table></code></div></div><p>That’s too bad! 20 errors.</p><p>I googled it and understand that this problem happens because the libraries that it used for it’s GUI is no longer available for OS X, so the problem can be solved using SDL instead.</p><p>Now you need to download and install SDL.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">brew</span> <span class="n">install</span> <span class="n">sdl</span>
</pre></table></code></div></div><p>Then compile the Bochs using the following syntax.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">--</span><span class="n">with</span><span class="o">-</span><span class="n">sdl</span>
<span class="n">make</span>
</pre></table></code></div></div><p>Even though this problem is reported to Bochs developers but it seems none of them uses OS X, I’m sure this problem will be solved in the future versions of Bochs.</p><p>Finally, it compiles without error, but actually, I want to use more features of Bochs like disasm and <strong>debug features</strong> and <strong>instrumentation</strong> and etc.</p><p>I use the following syntax to compile the Bochs:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="p">.</span><span class="o">/</span><span class="n">configure</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">cpu</span><span class="o">-</span><span class="n">level</span><span class="o">=</span><span class="mi">6</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">x86</span><span class="o">-</span><span class="mi">64</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">vmx</span><span class="o">=</span><span class="mi">2</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">pci</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">usb</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">usb</span><span class="o">-</span><span class="n">ohci</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">debugger</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">disasm</span> <span class="o">--</span><span class="n">with</span><span class="o">-</span><span class="n">sdl</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">instrumentation</span><span class="o">=</span><span class="s">"instrument/stubs"</span> <span class="o">--</span><span class="n">enable</span><span class="o">-</span><span class="n">cdrom</span>
<span class="n">make</span>
</pre></table></code></div></div><p>If there isn’t any problem, you can now run the Bochs.</p><p>This time, when I run Bochs it gives me the following error:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">Sinas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="o">:</span><span class="n">bochs</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span> <span class="n">sina</span><span class="err">$</span> <span class="n">bochs</span> 
<span class="o">========================================================================</span>
                       <span class="n">Bochs</span> <span class="n">x86</span> <span class="n">Emulator</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span>
               <span class="n">Built</span> <span class="n">from</span> <span class="n">SVN</span> <span class="n">snapshot</span> <span class="n">on</span> <span class="n">April</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2017</span>
                  <span class="n">Compiled</span> <span class="n">on</span> <span class="n">Apr</span> <span class="mi">15</span> <span class="mi">2018</span> <span class="n">at</span> <span class="mi">14</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">06</span>
<span class="o">========================================================================</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span>      <span class="p">]</span> <span class="n">BXSHARE</span> <span class="n">not</span> <span class="n">set</span><span class="p">.</span> <span class="n">using</span> <span class="n">compile</span> <span class="n">time</span> <span class="k">default</span> <span class="err">'</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">bochs</span><span class="err">'</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span>      <span class="p">]</span> <span class="n">reading</span> <span class="n">configuration</span> <span class="n">from</span> <span class="p">.</span><span class="n">bochsrc</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span>      <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">187</span><span class="o">:</span> <span class="n">wrong</span> <span class="n">value</span> <span class="k">for</span> <span class="n">parameter</span> <span class="err">'</span><span class="n">model</span><span class="err">'</span>
<span class="mo">00000000000</span><span class="n">p</span><span class="p">[</span>      <span class="p">]</span> <span class="o">&gt;&gt;</span><span class="n">PANIC</span><span class="o">&lt;&lt;</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">187</span><span class="o">:</span> <span class="n">cpu</span> <span class="n">directive</span> <span class="n">malformed</span><span class="p">.</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span><span class="n">SIM</span>   <span class="p">]</span> <span class="n">notify</span> <span class="n">called</span><span class="p">,</span> <span class="n">but</span> <span class="n">no</span> <span class="n">bxevent_callback</span> <span class="n">function</span> <span class="n">is</span> <span class="n">registered</span>
<span class="o">========================================================================</span>
<span class="n">Bochs</span> <span class="n">is</span> <span class="n">exiting</span> <span class="n">with</span> <span class="n">the</span> <span class="n">following</span> <span class="n">message</span><span class="o">:</span>
<span class="p">[</span>      <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">187</span><span class="o">:</span> <span class="n">cpu</span> <span class="n">directive</span> <span class="n">malformed</span><span class="p">.</span>
<span class="o">========================================================================</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span><span class="n">SIM</span>   <span class="p">]</span> <span class="n">quit_sim</span> <span class="n">called</span> <span class="n">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
</pre></table></code></div></div><p>Actually, this problem happens because the CPU architecture that selected in “.bochsrc” file is not available in the current built.</p><p>You should run the following command in order to get the supported CPUs:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">bochs</span> <span class="o">--</span><span class="n">help</span> <span class="n">cpu</span>
</pre></table></code></div></div><p>Then I modified the following line:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">cpu:</span> <span class="n">model</span><span class="o">=</span><span class="n">core2__penryn__t9600</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ips</span><span class="o">=</span><span class="mi">50000000</span><span class="p">,</span> <span class="n">reset__on__triple__fault</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ignore__bad__msrs</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">msrs</span><span class="o">=</span><span class="s">"msrs.def"</span>
</pre></table></code></div></div><p>change the “core2_penryn_t9600” to e.g “core_duo_t2400_yonah”.</p><p>Running bochs again produces such error :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="n">Sinas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="o">:</span><span class="n">bochs</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span> <span class="n">sina</span><span class="err">$</span> <span class="n">bochs</span> 
<span class="o">========================================================================</span>
                       <span class="n">Bochs</span> <span class="n">x86</span> <span class="n">Emulator</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span>
               <span class="n">Built</span> <span class="n">from</span> <span class="n">SVN</span> <span class="n">snapshot</span> <span class="n">on</span> <span class="n">April</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2017</span>
                  <span class="n">Compiled</span> <span class="n">on</span> <span class="n">Apr</span> <span class="mi">15</span> <span class="mi">2018</span> <span class="n">at</span> <span class="mi">14</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">06</span>
<span class="o">========================================================================</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span>      <span class="p">]</span> <span class="n">BXSHARE</span> <span class="n">not</span> <span class="n">set</span><span class="p">.</span> <span class="n">using</span> <span class="n">compile</span> <span class="n">time</span> <span class="k">default</span> <span class="err">'</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">bochs</span><span class="err">'</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span>      <span class="p">]</span> <span class="n">reading</span> <span class="n">configuration</span> <span class="n">from</span> <span class="p">.</span><span class="n">bochsrc</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span>      <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">718</span><span class="o">:</span> <span class="n">ataX</span><span class="o">-</span><span class="n">master</span><span class="o">/</span><span class="n">slave</span> <span class="n">CHS</span> <span class="n">set</span> <span class="n">to</span> <span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="o">-</span> <span class="n">autodetection</span> <span class="n">enabled</span>
<span class="mo">00000000000</span><span class="n">p</span><span class="p">[</span>      <span class="p">]</span> <span class="o">&gt;&gt;</span><span class="n">PANIC</span><span class="o">&lt;&lt;</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">914</span><span class="o">:</span> <span class="n">Bochs</span> <span class="n">is</span> <span class="n">not</span> <span class="n">compiled</span> <span class="n">with</span> <span class="n">lowlevel</span> <span class="n">sound</span> <span class="n">support</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span><span class="n">SIM</span>   <span class="p">]</span> <span class="n">notify</span> <span class="n">called</span><span class="p">,</span> <span class="n">but</span> <span class="n">no</span> <span class="n">bxevent_callback</span> <span class="n">function</span> <span class="n">is</span> <span class="n">registered</span>
<span class="o">========================================================================</span>
<span class="n">Bochs</span> <span class="n">is</span> <span class="n">exiting</span> <span class="n">with</span> <span class="n">the</span> <span class="n">following</span> <span class="n">message</span><span class="o">:</span>
<span class="p">[</span>      <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">914</span><span class="o">:</span> <span class="n">Bochs</span> <span class="n">is</span> <span class="n">not</span> <span class="n">compiled</span> <span class="n">with</span> <span class="n">lowlevel</span> <span class="n">sound</span> <span class="n">support</span>
<span class="o">========================================================================</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span><span class="n">SIM</span>   <span class="p">]</span> <span class="n">quit_sim</span> <span class="n">called</span> <span class="n">with</span> <span class="n">exit</span> <span class="n">code</span> <span class="mi">1</span>
</pre></table></code></div></div><p>It is because we didn’t configure Bochs for preparing sound device and we use “sound” option in “.bochsrc”, in order to build with sound support you can use one of the “–enable-sb16” or “–enable-es1370” in configuring and “make” again but I rather remove the following line from “.bochsrc” to build it again.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nl">sound:</span> <span class="n">driver</span><span class="o">=</span><span class="k">default</span><span class="p">,</span> <span class="n">waveout</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">dsp</span><span class="p">.</span> <span class="n">wavein</span><span class="o">=</span><span class="p">,</span> <span class="n">midiout</span><span class="o">=</span>
</pre></table></code></div></div><p>Now it runs without error.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre><span class="n">Sinas</span><span class="o">-</span><span class="n">MacBook</span><span class="o">-</span><span class="n">Pro</span><span class="o">:</span><span class="n">bochs</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span> <span class="n">sina</span><span class="err">$</span> <span class="n">bochs</span> 
<span class="o">========================================================================</span>
                       <span class="n">Bochs</span> <span class="n">x86</span> <span class="n">Emulator</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">9</span>
               <span class="n">Built</span> <span class="n">from</span> <span class="n">SVN</span> <span class="n">snapshot</span> <span class="n">on</span> <span class="n">April</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2017</span>
                  <span class="n">Compiled</span> <span class="n">on</span> <span class="n">Apr</span> <span class="mi">15</span> <span class="mi">2018</span> <span class="n">at</span> <span class="mi">14</span><span class="o">:</span><span class="mi">58</span><span class="o">:</span><span class="mo">06</span>
<span class="o">========================================================================</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span>      <span class="p">]</span> <span class="n">BXSHARE</span> <span class="n">not</span> <span class="n">set</span><span class="p">.</span> <span class="n">using</span> <span class="n">compile</span> <span class="n">time</span> <span class="k">default</span> <span class="err">'</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">bochs</span><span class="err">'</span>
<span class="mo">00000000000</span><span class="n">i</span><span class="p">[</span>      <span class="p">]</span> <span class="n">reading</span> <span class="n">configuration</span> <span class="n">from</span> <span class="p">.</span><span class="n">bochsrc</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span>      <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">718</span><span class="o">:</span> <span class="n">ataX</span><span class="o">-</span><span class="n">master</span><span class="o">/</span><span class="n">slave</span> <span class="n">CHS</span> <span class="n">set</span> <span class="n">to</span> <span class="mi">0</span><span class="o">/</span><span class="mi">0</span><span class="o">/</span><span class="mi">0</span> <span class="o">-</span> <span class="n">autodetection</span> <span class="n">enabled</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span>      <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">925</span><span class="o">:</span> <span class="n">wrong</span> <span class="n">value</span> <span class="k">for</span> <span class="n">parameter</span> <span class="err">'</span><span class="n">mode</span><span class="err">'</span>
<span class="mo">00000000000</span><span class="n">e</span><span class="p">[</span><span class="n">PCSPK</span> <span class="p">]</span> <span class="p">.</span><span class="n">bochsrc</span><span class="o">:</span><span class="mi">925</span><span class="o">:</span> <span class="n">unknown</span> <span class="n">parameter</span> <span class="k">for</span> <span class="n">speaker</span> <span class="n">ignored</span><span class="p">.</span>
<span class="o">------------------------------</span>
<span class="n">Bochs</span> <span class="n">Configuration</span><span class="o">:</span> <span class="n">Main</span> <span class="n">Menu</span>
<span class="o">------------------------------</span>

<span class="n">This</span> <span class="n">is</span> <span class="n">the</span> <span class="n">Bochs</span> <span class="n">Configuration</span> <span class="n">Interface</span><span class="p">,</span> <span class="n">where</span> <span class="n">you</span> <span class="n">can</span> <span class="n">describe</span> <span class="n">the</span>
<span class="n">machine</span> <span class="n">that</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">simulate</span><span class="p">.</span>  <span class="n">Bochs</span> <span class="n">has</span> <span class="n">already</span> <span class="n">searched</span> <span class="k">for</span> <span class="n">a</span>
<span class="n">configuration</span> <span class="n">file</span> <span class="p">(</span><span class="n">typically</span> <span class="n">called</span> <span class="n">bochsrc</span><span class="p">.</span><span class="n">txt</span><span class="p">)</span> <span class="n">and</span> <span class="n">loaded</span> <span class="n">it</span> <span class="k">if</span> <span class="n">it</span>
<span class="n">could</span> <span class="n">be</span> <span class="n">found</span><span class="p">.</span>  <span class="n">When</span> <span class="n">you</span> <span class="n">are</span> <span class="n">satisfied</span> <span class="n">with</span> <span class="n">the</span> <span class="n">configuration</span><span class="p">,</span> <span class="n">go</span>
<span class="n">ahead</span> <span class="n">and</span> <span class="n">start</span> <span class="n">the</span> <span class="n">simulation</span><span class="p">.</span>

<span class="n">You</span> <span class="n">can</span> <span class="n">also</span> <span class="n">start</span> <span class="n">bochs</span> <span class="n">with</span> <span class="n">the</span> <span class="o">-</span><span class="n">q</span> <span class="n">option</span> <span class="n">to</span> <span class="n">skip</span> <span class="n">these</span> <span class="n">menus</span><span class="p">.</span>

<span class="mi">1</span><span class="p">.</span> <span class="n">Restore</span> <span class="n">factory</span> <span class="k">default</span> <span class="n">configuration</span>
<span class="mi">2</span><span class="p">.</span> <span class="n">Read</span> <span class="n">options</span> <span class="n">from</span><span class="p">...</span>
<span class="mi">3</span><span class="p">.</span> <span class="n">Edit</span> <span class="n">options</span>
<span class="mi">4</span><span class="p">.</span> <span class="n">Save</span> <span class="n">options</span> <span class="n">to</span><span class="p">...</span>
<span class="mi">5</span><span class="p">.</span> <span class="n">Restore</span> <span class="n">the</span> <span class="n">Bochs</span> <span class="n">state</span> <span class="n">from</span><span class="p">...</span>
<span class="mi">6</span><span class="p">.</span> <span class="n">Begin</span> <span class="n">simulation</span>
<span class="mi">7</span><span class="p">.</span> <span class="n">Quit</span> <span class="n">now</span>

<span class="n">Please</span> <span class="n">choose</span> <span class="n">one</span><span class="o">:</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span>
</pre></table></code></div></div><h2 id="building-bochs-on-windows"><span class="mr-2">Building Bochs on Windows</span><a href="#building-bochs-on-windows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>To build Bochs for Windows you have multiple options, like building with Cygwin or MinGW but I’d rather build Bochs with Visual Studio instead.</p><p>Download <strong>(bochs-x.x.x-msvc-src.zip)</strong> latest version from <a href="https://sourceforge.net/projects/bochs/files/bochs/">here</a>.</p><p>Extract the bochs-x.x.x-msvc-src.zip go to vs2013 and open <strong>“bochs.sln”</strong>.</p><p>You need to enable some of the features before building the solution. (It’s like ./configure –enable-x in OS X and Linux)</p><p>Go to <strong>“config.h”</strong> and modify it like this:</p><p>In order to enable debugging make sure your config file is :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="cp">#define BX__GDBSTUB 1
#define BX__DEBUGGER 1
#define BX__DISASM 1
#define BX__DEBUGGER__GUI 1
</span></pre></table></code></div></div><p>I also need Instrumentation so changed the following line:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">#define BX__INSTRUMENTATION 1
</span></pre></table></code></div></div><p>make sure disable <strong>BX_SUPPORT_HANDLERS_CHAINING_SPEEDUPS</strong> because of some incompatibility issues.</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">#define BX__SUPPORT__HANDLERS__CHAINING__SPEEDUPS 0
</span></pre></table></code></div></div><p>Then trying to build and this time it gives me the following error:</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">unresolved</span> <span class="n">external</span> <span class="n">symbol</span> <span class="n">____imp____WSAStartup</span><span class="err">@</span><span class="mi">8</span> <span class="n">referenced</span> <span class="n">in</span> <span class="n">function</span> <span class="n">__main</span>	
</pre></table></code></div></div><p>And other such errors which are linking problems.</p><p>I add the following line to <strong>bxhub.cc</strong> :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">#pragma comment(lib,"Ws2__32.lib")
</span></pre></table></code></div></div><p>That line solves the linking problems. If there isn’t any error then just build the solution.</p><h2 id="installing-windows-on-bochs"><span class="mr-2">Installing Windows on Bochs</span><a href="#installing-windows-on-bochs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Installing an operating system in Bochs is a little tricky, open <strong>bochs.exe</strong> (from what you built before.) then make sure that it starts without any problem (some systems have problem opening Bochs !).</p><p>Bochs uses an image file for the purpose of its hard disk, there is a tool called <strong>bximage.exe</strong> which creates such file for you.</p><p>Open <strong>bximage.exe</strong> :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="o">========================================================================</span>
                                <span class="n">bximage</span>
  <span class="n">Disk</span> <span class="n">Image</span> <span class="n">Creation</span> <span class="o">/</span> <span class="n">Conversion</span> <span class="o">/</span> <span class="n">Resize</span> <span class="n">and</span> <span class="n">Commit</span> <span class="n">Tool</span> <span class="k">for</span> <span class="n">Bochs</span>
         <span class="err">$</span><span class="n">Id</span><span class="o">:</span> <span class="n">bximage</span><span class="p">.</span><span class="n">cc</span> <span class="mi">13069</span> <span class="mi">2017</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">12</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">52</span><span class="n">Z</span> <span class="n">vruppert</span> <span class="err">$</span>
<span class="o">========================================================================</span>

<span class="mi">1</span><span class="p">.</span> <span class="n">Create</span> <span class="n">new</span> <span class="n">floppy</span> <span class="n">or</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span>
<span class="mi">2</span><span class="p">.</span> <span class="n">Convert</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span> <span class="n">to</span> <span class="n">other</span> <span class="n">format</span> <span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="mi">3</span><span class="p">.</span> <span class="n">Resize</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span>
<span class="mi">4</span><span class="p">.</span> <span class="n">Commit</span> <span class="err">'</span><span class="n">undoable</span><span class="err">'</span> <span class="n">redolog</span> <span class="n">to</span> <span class="n">base</span> <span class="n">image</span>
<span class="mi">5</span><span class="p">.</span> <span class="n">Disk</span> <span class="n">image</span> <span class="n">info</span>

<span class="mi">0</span><span class="p">.</span> <span class="n">Quit</span>

<span class="n">Please</span> <span class="n">choose</span> <span class="n">one</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></table></code></div></div><p>Then choose 1 (Create new floppy or hard disk image). In the second step choose <strong>hd</strong> for device type, <strong>growing</strong> for the next question and then choose how much space you need to allocate to your emulated machine.</p><p>In the last step specify a name and you’re good to go!</p><p>A complete result of bximage is like :</p><div class="language-c highlighter-rouge"><div class="code-header"> <span data-label-text="C"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="o">========================================================================</span>
                                <span class="n">bximage</span>
  <span class="n">Disk</span> <span class="n">Image</span> <span class="n">Creation</span> <span class="o">/</span> <span class="n">Conversion</span> <span class="o">/</span> <span class="n">Resize</span> <span class="n">and</span> <span class="n">Commit</span> <span class="n">Tool</span> <span class="k">for</span> <span class="n">Bochs</span>
         <span class="err">$</span><span class="n">Id</span><span class="o">:</span> <span class="n">bximage</span><span class="p">.</span><span class="n">cc</span> <span class="mi">13069</span> <span class="mi">2017</span><span class="o">-</span><span class="mo">02</span><span class="o">-</span><span class="mi">12</span> <span class="mi">16</span><span class="o">:</span><span class="mi">51</span><span class="o">:</span><span class="mi">52</span><span class="n">Z</span> <span class="n">vruppert</span> <span class="err">$</span>
<span class="o">========================================================================</span>

<span class="mi">1</span><span class="p">.</span> <span class="n">Create</span> <span class="n">new</span> <span class="n">floppy</span> <span class="n">or</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span>
<span class="mi">2</span><span class="p">.</span> <span class="n">Convert</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span> <span class="n">to</span> <span class="n">other</span> <span class="n">format</span> <span class="p">(</span><span class="n">mode</span><span class="p">)</span>
<span class="mi">3</span><span class="p">.</span> <span class="n">Resize</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span>
<span class="mi">4</span><span class="p">.</span> <span class="n">Commit</span> <span class="err">'</span><span class="n">undoable</span><span class="err">'</span> <span class="n">redolog</span> <span class="n">to</span> <span class="n">base</span> <span class="n">image</span>
<span class="mi">5</span><span class="p">.</span> <span class="n">Disk</span> <span class="n">image</span> <span class="n">info</span>

<span class="mi">0</span><span class="p">.</span> <span class="n">Quit</span>

<span class="n">Please</span> <span class="n">choose</span> <span class="n">one</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="mi">1</span>

<span class="n">Create</span> <span class="n">image</span>

<span class="n">Do</span> <span class="n">you</span> <span class="n">want</span> <span class="n">to</span> <span class="n">create</span> <span class="n">a</span> <span class="n">floppy</span> <span class="n">disk</span> <span class="n">image</span> <span class="n">or</span> <span class="n">a</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span><span class="o">?</span>
<span class="n">Please</span> <span class="n">type</span> <span class="n">hd</span> <span class="n">or</span> <span class="n">fd</span><span class="p">.</span> <span class="p">[</span><span class="n">hd</span><span class="p">]</span> <span class="n">hd</span>

<span class="n">What</span> <span class="n">kind</span> <span class="n">of</span> <span class="n">image</span> <span class="n">should</span> <span class="n">I</span> <span class="n">create</span><span class="o">?</span>
<span class="n">Please</span> <span class="n">type</span> <span class="n">flat</span><span class="p">,</span> <span class="n">sparse</span><span class="p">,</span> <span class="n">growing</span><span class="p">,</span> <span class="n">vpc</span> <span class="n">or</span> <span class="n">vmware4</span><span class="p">.</span> <span class="p">[</span><span class="n">flat</span><span class="p">]</span> <span class="n">growing</span>

<span class="n">Enter</span> <span class="n">the</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">size</span> <span class="n">in</span> <span class="n">megabytes</span><span class="p">,</span> <span class="n">between</span> <span class="mi">10</span> <span class="n">and</span> <span class="mi">8257535</span>
<span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="mi">10000</span>

<span class="n">What</span> <span class="n">should</span> <span class="n">be</span> <span class="n">the</span> <span class="n">name</span> <span class="n">of</span> <span class="n">the</span> <span class="n">image</span><span class="o">?</span>
<span class="p">[</span><span class="n">c</span><span class="p">.</span><span class="n">img</span><span class="p">]</span> <span class="n">c</span><span class="p">.</span><span class="n">img</span>

<span class="n">Creating</span> <span class="n">hard</span> <span class="n">disk</span> <span class="n">image</span> <span class="err">'</span><span class="n">c</span><span class="p">.</span><span class="n">img</span><span class="err">'</span> <span class="n">with</span> <span class="n">CHS</span><span class="o">=</span><span class="mi">20317</span><span class="o">/</span><span class="mi">16</span><span class="o">/</span><span class="mi">63</span>
<span class="n">redolog</span> <span class="o">:</span> <span class="n">creating</span> <span class="n">redolog</span> <span class="n">c</span><span class="p">.</span><span class="n">img</span>
<span class="n">redolog</span> <span class="o">:</span> <span class="n">Standard</span> <span class="n">Header</span> <span class="o">:</span> <span class="n">magic</span><span class="o">=</span><span class="err">'</span><span class="n">Bochs</span> <span class="n">Virtual</span> <span class="n">HD</span> <span class="n">Image</span><span class="err">'</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="err">'</span><span class="n">Redolog</span><span class="err">'</span><span class="p">,</span> <span class="n">subtype</span><span class="o">=</span><span class="err">'</span><span class="n">Growing</span><span class="err">'</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="mi">2</span><span class="p">.</span><span class="mi">0</span>
<span class="n">redolog</span> <span class="o">:</span> <span class="n">Specific</span> <span class="n">Header</span> <span class="o">:</span> <span class="err">#</span><span class="n">entries</span><span class="o">=</span><span class="mi">32768</span><span class="p">,</span> <span class="n">bitmap</span> <span class="n">size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">exent</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">524288</span> <span class="n">disk</span> <span class="n">size</span> <span class="o">=</span> <span class="mi">10485522432</span>

<span class="n">The</span> <span class="n">following</span> <span class="n">line</span> <span class="n">should</span> <span class="n">appear</span> <span class="n">in</span> <span class="n">your</span> <span class="n">bochsrc</span><span class="o">:</span>
  <span class="n">ata0</span><span class="o">-</span><span class="n">master</span><span class="o">:</span> <span class="n">type</span><span class="o">=</span><span class="n">disk</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s">"c.img"</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">growing</span>
<span class="p">(</span><span class="n">The</span> <span class="n">line</span> <span class="n">is</span> <span class="n">stored</span> <span class="n">in</span> <span class="n">your</span> <span class="n">windows</span> <span class="n">clipboard</span><span class="p">,</span> <span class="n">use</span> <span class="n">CTRL</span><span class="o">-</span><span class="n">V</span> <span class="n">to</span> <span class="n">paste</span><span class="p">)</span>

<span class="n">Press</span> <span class="n">any</span> <span class="n">key</span> <span class="n">to</span> <span class="k">continue</span>
</pre></table></code></div></div><p>After creating the image file, now you need to configure your Bochs machine.</p><p>Open the <strong>Bochs.exe</strong> and edit the memory option.</p><p><img data-src="../../assets/images/bochs-gui.png" alt="" data-proofer-ignore></p><p>Set the <strong>memory size (megabytes)</strong> and <strong>host allocated size (megabytes)</strong> to a value greater than 32!  I choose 1000.</p><p>Then edit <strong>CPU</strong> option &gt; <strong>CPU Configuration</strong> to <strong>turion64_tyler</strong> or whatever supports x86-64, make sure to set a proper value for <strong>Emulated instructions per second (IPS)</strong>. Press OK and edit <strong>Disk &amp; Boot &gt; ATA Channel &gt; First HD/CD on channel 0</strong>. In this window set <strong>Type of ATA device</strong> to <strong>disk</strong>, set <strong>path or physical device name</strong> to the <strong>c.img</strong> (the file that is created previously by <strong>bximage</strong>), <strong>Type of disk image</strong> to <strong>growing</strong>, <strong>Cylinders</strong> to <strong>20317</strong>, <strong>heads</strong> to <strong>16</strong>, <strong>Sectors per track</strong> to <strong>63</strong>.</p><p>Now go to another tab (<strong>Second HD/CD on channel 0</strong>) and set the <strong>type of disk</strong> to cdrom, <strong>Path or physical device name</strong> to the Windows ISO file.</p><p>For the last step go to <strong>Boot Options</strong>, set <strong>Boot drive #1</strong> to <strong>disk</strong> and <strong>Boot drive #2</strong> to <strong>cdrom</strong>.</p><p>That’s it, make sure to save your configuration to avoid doing these steps again and then press <strong>start</strong>.</p><p>Select <strong>continue and don’t ask again</strong> if a prompt comes to the screen then restart the machine and you should see the Windows installation.</p><p>If you see the following picture, then you’re done.</p><p><img data-src="../../assets/images/bochs-starting-windows.png" alt="final-bochs" data-proofer-ignore></p><p>By now, you should’ve configured Bochs, Let’s use more features of Bochs in the <a href="http://rayanfam.com/topics/bochs-emulator-debug-and-instrument/">next post</a>. (<a href="http://rayanfam.com/topics/bochs-emulator-debug-and-instrument/">Bochs Emulator - Debug &amp; Instrument</a>).</p><h2 id="references"><span class="mr-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li>[Bochs User Manual] (<a href="http://bochs.sourceforge.net/doc/docbook/user/index.html">http://bochs.sourceforge.net/doc/docbook/user/index.html</a>)<li>[Platform emulation with Bochs] (<a href="https://www.ibm.com/developerworks/library/l-bochs">https://www.ibm.com/developerworks/library/l-bochs</a>) - [PDF Version] (<a href="https://www.ibm.com/developerworks/library/l-bochs/l-bochs-pdf.pdf">https://www.ibm.com/developerworks/library/l-bochs/l-bochs-pdf.pdf</a>)<li>[Wikipedia - Bochs] (<a href="https://en.wikipedia.org/wiki/Bochs">https://en.wikipedia.org/wiki/Bochs</a>)</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/emulator/'>emulator</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/bochs-emulator/" class="post-tag no-text-decoration" >bochs-emulator</a> <a href="/tags/bochs-os-x/" class="post-tag no-text-decoration" >bochs-os-x</a> <a href="/tags/bochs-windows/" class="post-tag no-text-decoration" >bochs-windows</a> <a href="/tags/compile-bochs/" class="post-tag no-text-decoration" >compile-bochs</a> <a href="/tags/config-bochs/" class="post-tag no-text-decoration" >config-bochs</a> <a href="/tags/install-bochs/" class="post-tag no-text-decoration" >install-bochs</a> <a href="/tags/install-windows-on-bochs/" class="post-tag no-text-decoration" >install-windows-on-bochs</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Bochs Emulator - Config &amp; Build on Windows and OS X - Rayanfam Blog&amp;url=https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Bochs Emulator - Config &amp; Build on Windows and OS X - Rayanfam Blog&amp;u=https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/&amp;text=Bochs Emulator - Config &amp; Build on Windows and OS X - Rayanfam Blog" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/topics/hypervisor-from-scratch-part-1/">Hypervisor From Scratch - Part 1: Basic Concepts & Configure Testing Environment</a><li><a href="/topics/hypervisor-from-scratch-part-2/">Hypervisor From Scratch – Part 2: Entering VMX Operation</a><li><a href="/topics/hypervisor-from-scratch-part-5/">Hypervisor From Scratch – Part 5: Setting up VMCS & Running Guest Code</a><li><a href="/topics/hypervisor-from-scratch-part-6/">Hypervisor From Scratch – Part 6: Virtualizing An Already Running System</a><li><a href="/topics/hypervisor-from-scratch-part-7/">Hypervisor From Scratch – Part 7: Using EPT & Page-Level Monitoring Features</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hypervisor/">hypervisor</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/cisco/">cisco</a> <a class="post-tag" href="/tags/invept/">invept</a> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/vmcs/">vmcs</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/cache/">cache</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/topics/bochs-emulator-debug-and-instrument/"><div class="card-body"> <em class="timeago small" data-ts="1524787200" > 2018-04-27 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Bochs Emulator - Debug & Instrument</h3><div class="text-muted small"><p> There is also another post about configuring and building Bochs on Windows &amp;amp; OS X if you have a problem compiling Bochs, take a look at here! In my opinion, Bochs is an amazing thing because...</p></div></div></a></div><div class="card"> <a href="/topics/hardware-design-stack/"><div class="card-body"> <em class="timeago small" data-ts="1696636800" > 2023-10-07 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building Silicon Dreams: An Adventure in Hardware Design</h3><div class="text-muted small"><p> Story Time Exploring the internals of processors has long been a fascination of mine. After spending a lot of time experiencing different processor features like hypervisor and configuring diffe...</p></div></div></a></div><div class="card"> <a href="/topics/hyperdbg-one-thousand-and-one-nights/"><div class="card-body"> <em class="timeago small" data-ts="1655078400" > 2022-06-13 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>HyperDbg’s One Thousand and One Nights</h3><div class="text-muted small"><p> This post is a different one, in that, it is more of an overview, rather than a technical post. Here, we provide a high-level summary of HyperDbg Debugger, its principles, and perspective. Intro...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/topics/survey-non-general-registers/" class="btn btn-outline-primary" prompt="Older"><p>A partial survey among non-general purpose registers</p></a> <a href="/topics/bochs-emulator-debug-and-instrument/" class="btn btn-outline-primary" prompt="Newer"><p>Bochs Emulator - Debug & Instrument</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://rayanfam.com/topics/bochs-config-and-build-on-windows-and-os-x/'; this.page.identifier = '/topics/bochs-config-and-build-on-windows-and-os-x/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://rayanfam.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/rayanfam">Rayanfam Blog</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/hypervisor/">hypervisor</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/debian/">debian</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/cisco/">cisco</a> <a class="post-tag" href="/tags/invept/">invept</a> <a class="post-tag" href="/tags/ios/">ios</a> <a class="post-tag" href="/tags/vmcs/">vmcs</a> <a class="post-tag" href="/tags/active-directory/">active-directory</a> <a class="post-tag" href="/tags/cache/">cache</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-P6M1BDG57Z"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-P6M1BDG57Z'); }); </script>
